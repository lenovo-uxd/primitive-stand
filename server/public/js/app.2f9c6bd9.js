(function(t){function e(e){for(var r,o,s=e[0],l=e[1],c=e[2],h=0,p=[];h<s.length;h++)o=s[h],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&p.push(n[o][0]),n[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],r=!0,s=1;s<i.length;s++){var l=i[s];0!==n[l]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var r={},n={app:0},a=[];function o(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=r,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(i,r,function(e){return t[e]}.bind(null,r));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"25f5":function(t,e,i){var r,n,a,o;i("4160"),i("c975"),i("fb6a"),i("a434"),i("b0c0"),i("d3b7"),i("ac1f"),i("466d"),i("38cf"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("159b");var s=i("7037");(function(i){"object"===s(e)&&"undefined"!==typeof t?t.exports=i():(n=[],r=i,a="function"===typeof r?r.apply(e,n):r,void 0===a||(t.exports=a))})((function(){return function t(e,i,r){function n(s,l){if(!i[s]){if(!e[s]){var c="function"==typeof o&&o;if(!l&&c)return o(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[s]={exports:{}};e[s][0].call(h.exports,(function(t){var i=e[s][1][t];return n(i||t)}),h,h.exports,t,e,i,r)}return i[s].exports}for(var a="function"==typeof o&&o,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,i){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"===typeof t}function a(t){return"number"===typeof t}function o(t){return"object"===s(t)&&null!==t}function l(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!a(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,i,r,a,s,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(i=this._events[t],l(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(o(i))for(a=Array.prototype.slice.call(arguments,1),c=i.slice(),r=c.length,s=0;s<r;s++)c[s].apply(this,a);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(i=l(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"===typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var i=!1;function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var i,r,a,s;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],a=i.length,r=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(i)){for(s=a;s-- >0;)if(i[s]===e||i[s].listener&&i[s].listener===e){r=s;break}if(r<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],n(i))this.removeListener(t,i);else if(i)while(i.length)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[],e},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,i){var r,n,a,o,s;s=navigator.userAgent.toLowerCase(),o=navigator.platform.toLowerCase(),r=s.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],a="ie"===r[1]&&document.documentMode,n={name:"version"===r[1]?r[3]:r[1],version:a||parseFloat("opera"===r[1]&&r[4]?r[4]:r[2]),platform:{name:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||o.match(/mac|win|linux/)||["other"])[0]}},n[n.name]=!0,n[n.name+parseInt(n.version,10)]=!0,n.platform[n.platform.name]=!0,e.exports=n},{}],3:[function(t,e,i){var r,n,a,o=function(t,e){for(var i in e)s.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},s={}.hasOwnProperty,l=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},c=[].slice;r=t("events").EventEmitter,a=t("./browser.coffee"),n=function(t){var e,i;function r(t){var i,r,n;for(r in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),e)n=e[r],null==(i=this.options)[r]&&(i[r]=n)}return o(r,t),e={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},i={delay:500,copy:!1},r.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},r.prototype.setOptions=function(t){var e,i,r;for(e in i=[],t)s.call(t,e)&&(r=t[e],i.push(this.setOption(e,r)));return i},r.prototype.addFrame=function(t,e){var r,n;for(n in null==e&&(e={}),r={},r.transparent=this.options.transparent,i)r[n]=e[n]||i[n];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!==typeof ImageData&&null!==ImageData&&t instanceof ImageData)r.data=t.data;else if("undefined"!==typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!==typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?r.data=this.getContextData(t):r.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?r.data=this.getImageData(t):r.image=t}return this.frames.push(r)},r.prototype.render=function(){var t,e,i;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,i;for(i=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)i.push(null);return i}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,i=e;0<=i?t<i:t>i;0<=i?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},r.prototype.abort=function(){var t;while(1){if(t=this.activeWorkers.shift(),null==t)break;this.log("killing active worker"),t.terminate()}return this.running=!1,this.emit("abort")},r.prototype.spawnWorkers=function(){var t,e,i;return t=Math.min(this.options.workers,this.frames.length),function(){i=[];for(var r=e=this.freeWorkers.length;e<=t?r<t:r>t;e<=t?r++:r--)i.push(r);return i}.apply(this).forEach(function(t){return function(e){var i;return t.log("spawning worker "+e),i=new Worker(t.options.workerScript),i.onmessage=function(e){return t.activeWorkers.splice(t.activeWorkers.indexOf(i),1),t.freeWorkers.push(i),t.frameFinished(e.data)},t.freeWorkers.push(i)}}(this)),t},r.prototype.frameFinished=function(t){var e,i;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,!0===this.options.globalPalette&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(e=1,i=this.freeWorkers.length;1<=i?e<i:e>i;1<=i?++e:--e)this.renderNextFrame();return l.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},r.prototype.finishRendering=function(){var t,e,i,r,n,a,o,s,l,c,u,h,p,d,f,g;for(s=0,d=this.imageParts,n=0,l=d.length;n<l;n++)e=d[n],s+=(e.data.length-1)*e.pageSize+e.cursor;for(s+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(s/1e3)+"kb"),t=new Uint8Array(s),h=0,f=this.imageParts,a=0,c=f.length;a<c;a++)for(e=f[a],g=e.data,i=o=0,u=g.length;o<u;i=++o)p=g[i],t.set(p,h),i===e.data.length-1?h+=e.cursor:h+=e.pageSize;return r=new Blob([t],{type:"image/gif"}),this.emit("finished",r,t)},r.prototype.renderNextFrame=function(){var t,e,i;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],i=this.freeWorkers.shift(),e=this.getTask(t),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(i),i.postMessage(e)},r.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},r.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),e=this._canvas.getContext("2d"),e.setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},r.prototype.getTask=function(t){var e,i;if(e=this.frames.indexOf(t),i={index:e,last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===a.name},null!=t.data)i.data=t.data;else if(null!=t.context)i.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");i.data=this.getImageData(t.image)}return i},r.prototype.log=function(){var t;if(t=1<=arguments.length?c.call(arguments,0):[],this.options.debug)return console.log.apply(console,t)},r}(r),e.exports=n},{"./browser.coffee":2,events:1}]},{},[3])(3)}))},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var r=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("img",{staticStyle:{visibility:"hidden",width:"1080px",height:"1920px"},attrs:{id:"shareBg",src:"/picture/share-bg2.png"}}),i("canvas",{staticStyle:{display:"none"},attrs:{id:"drawFrame"}}),i("canvas",{staticStyle:{display:"none",position:"fixed",left:"0",top:"0"},attrs:{id:"sharePoster",width:"1080",height:"1920"}}),i("div",{attrs:{id:"inputTextSvg",width:"80%",height:"200px"}}),i("div",{class:0==t.pageIndex||5==t.pageIndex?"bg"+t.pageIndex:"bg1234"}),i("canvas",{class:0==t.pageIndex||5==t.pageIndex?"show"+t.pageIndex:"show1234",attrs:{id:"canvas",width:"1080px",height:"1920px"}}),i("img",{attrs:{id:"canvasCopy",src:""}}),i("video",{class:0==t.pageIndex||5==t.pageIndex?"screen"+t.pageIndex:"screen1234",attrs:{preload:"auto",src:"/video/screen.mp4",autoplay:"",loop:"",muted:""},domProps:{muted:!0}}),i("video",{class:0==t.pageIndex||5==t.pageIndex?"video"+t.pageIndex:"video1234",attrs:{id:"videoel",preload:"auto",autoPlay:""}}),i("img",{staticClass:"title",attrs:{src:"/picture/title"+t.pageIndex+"@x3.png",alt:"magic draw"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.pageIndex>=4,expression:"pageIndex >= 4"}],style:5==t.pageIndex?"transform: scale(0.8); transform-origin: 50% 35%;":"",attrs:{id:"paint"}}),i("img",{directives:[{name:"show",rawName:"v-show",value:0==t.pageIndex,expression:"pageIndex == 0"}],staticClass:"decor-bottom",attrs:{src:"/picture/decor-bottom.png"}}),i("img",{class:0==t.pageIndex||5==t.pageIndex?"machine"+t.pageIndex:"machine1234",attrs:{src:"/picture/machine@x3.png",alt:"machine"}}),i("img",{directives:[{name:"show",rawName:"v-show",value:0==t.pageIndex,expression:"pageIndex == 0"}],staticClass:"decor-top",attrs:{src:"/picture/decor-top.png"}}),t.count<=3&&t.count>=1?i("img",{staticClass:"count",attrs:{src:"/picture/count"+t.count+"@x3.png"}}):t._e(),i("div",{attrs:{id:"overlay"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:"text"==t.mode&&3==t.pageIndex,expression:"mode == 'text' && pageIndex == 3"}],staticClass:"input-container"},[i("input",{staticClass:"input",attrs:{id:"input",placeholder:"点击输入名字",autocomplete:"off"},domProps:{value:t.input},on:{input:t.onInputChange,focus:function(e){t.isInputting=!0},blur:function(e){t.isInputting=!1}}}),i("img",{directives:[{name:"show",rawName:"v-show",value:t.isInputting,expression:"isInputting"}],staticClass:"finish-btn",attrs:{src:"/picture/finishbtn.png"}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:"shape"==t.mode&&3==t.pageIndex,expression:"mode == 'shape' && pageIndex == 3"}],staticClass:"shape-container"},[i("div",{staticClass:"text"},[t._v("请选择：")]),i("div",{staticClass:"shapes"},t._l(t.shapeList,(function(e){return i("img",{key:e,class:e==t.shape?"checked-shape":"shape",attrs:{src:"/picture/"+e+".png"},on:{click:t.setShape}})})),0)]),i("img",{class:0==t.pageIndex||5==t.pageIndex?"bottom-info"+t.pageIndex:"bottom-info1234",attrs:{src:"/picture/infobottom"+t.pageIndex+"@x3.png",alt:"info bottom"}}),i("canvas",{directives:[{name:"show",rawName:"v-show",value:5==t.pageIndex,expression:"pageIndex == 5"}],attrs:{id:"shareQrcode"}}),i("img",{directives:[{name:"show",rawName:"v-show",value:5==t.pageIndex,expression:"pageIndex == 5"}],attrs:{id:"qrcode",src:"/picture/qrcode.jpg"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:5==t.pageIndex,expression:"pageIndex == 5"}],staticClass:"timestamp"},[t._v(t._s(t.timestamp))]),i("img",{directives:[{name:"show",rawName:"v-show",value:3!=t.pageIndex,expression:"pageIndex != 3"}],class:0==t.pageIndex||5==t.pageIndex?"btn0"+t.pageIndex:"btn01234",attrs:{src:"/picture/btn00@x3.png",alt:"button"},on:{click:t.firstPageAni}}),i("img",{class:0==t.pageIndex||5==t.pageIndex?"back-btn"+t.pageIndex:"back-btn1234",attrs:{src:"/picture/back-normal@x3.png",alt:"button"},on:{click:t.back}}),i("img",{directives:[{name:"show",rawName:"v-show",value:0==t.pageIndex,expression:"pageIndex == 0"}],staticClass:"btn0",attrs:{src:"/picture/btn0@x3.png",alt:"button"},on:{click:t.next}}),i("img",{directives:[{name:"show",rawName:"v-show",value:t.isBtn1Show,expression:"isBtn1Show"}],staticClass:"btn1234",attrs:{src:"/picture/btn1@x3.png",alt:"button"},on:{click:t.next}}),i("img",{directives:[{name:"show",rawName:"v-show",value:2==t.pageIndex,expression:"pageIndex == 2"}],staticClass:"btn1234",attrs:{src:"/picture/btn2@x3.png",alt:"button"},on:{click:t.next}}),i("img",{directives:[{name:"show",rawName:"v-show",value:3==t.pageIndex,expression:"pageIndex == 3"}],staticClass:"btn1234",attrs:{src:"/picture/btn3@x3.png",alt:"button"},on:{click:t.next}}),i("img",{directives:[{name:"show",rawName:"v-show",value:4==t.pageIndex,expression:"pageIndex == 4"}],staticClass:"btn1234",attrs:{src:"/picture/btn4@x3.png",alt:"button"},on:{click:t.next}}),i("img",{directives:[{name:"show",rawName:"v-show",value:5==t.pageIndex,expression:"pageIndex == 5"}],staticClass:"btn5",attrs:{src:"/picture/btn5@x3.png",alt:"button"},on:{click:t.next}}),i("img",{directives:[{name:"show",rawName:"v-show",value:t.isLoading&&4==t.pageIndex,expression:"isLoading && pageIndex == 4"}],staticClass:"loading",attrs:{src:"/picture/loading.gif"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[i("audio",{attrs:{id:"button-audio",src:"/audio/button.mp3",preload:""}}),i("audio",{attrs:{id:"count-audio",src:"/audio/count.mp3",preload:""}}),i("audio",{attrs:{id:"keyboard-audio",src:"/audio/keyboard.mp3",preload:""}}),i("audio",{attrs:{id:"shoot-audio",src:"/audio/shoot.mp3",preload:""}})])])},a=[],o=(i("cb29"),i("4160"),i("b0c0"),i("d3b7"),i("ac1f"),i("25f0"),i("5319"),i("1276"),i("498a"),i("159b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.keyboardClass})}),s=[],l=i("dd7f"),c=i.n(l),u=(i("d2db"),{name:"SimpleKeyboard",props:{keyboardClass:{default:"simple-keyboard",type:String},input:{type:String}},data:function(){return{keyboard:null}},mounted:function(){this.keyboard=new c.a({onChange:this.onChange,onKeyPress:this.onKeyPress})},methods:{onChange:function(t){this.$emit("onChange",t)},onKeyPress:function(t){this.$emit("onKeyPress",t),"{shift}"!==t&&"{lock}"!==t||this.handleShift()},handleShift:function(){var t=this.keyboard.options.layoutName,e="default"===t?"shift":"default";this.keyboard.setOptions({layoutName:e})}},watch:{input:function(t){this.keyboard.setInput(t)}}}),h=u,p=i("2877"),d=Object(p["a"])(h,o,s,!1,null,"45ac0b00",null),f=d.exports,g=i("d055"),v=i.n(g),m=i("4378"),x=(i("a15b"),i("fb6a"),i("4d63"),i("cfc3"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),function(t,e,i){var r=function(t,e,i){var r=new RegExp("\\b"+e+" \\w+ (\\w+)","ig");t.replace(r,(function(t,e){return i[e]=0,t}))},n=function(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.log(t.getShaderInfoLog(r)),null)};this.uniform={},this.attribute={};var a=n(t,e,t.VERTEX_SHADER),o=n(t,i,t.FRAGMENT_SHADER);for(var s in this.id=t.createProgram(),t.attachShader(this.id,a),t.attachShader(this.id,o),t.linkProgram(this.id),t.getProgramParameter(this.id,t.LINK_STATUS)||console.log(t.getProgramInfoLog(this.id)),t.useProgram(this.id),r(e,"attribute",this.attribute),this.attribute)this.attribute[s]=t.getAttribLocation(this.id,s);for(var l in r(e,"uniform",this.uniform),r(i,"uniform",this.uniform),this.uniform)this.uniform[l]=t.getUniformLocation(this.id,l)}),y=window.WebGLImageFilter=function(t){t||(t={});var e=null,i=0,r=null,n=!1,a=-1,o=[null,null],s=[],l=-1,c=-1,u=null,h=null,p=t.canvas||document.createElement("canvas"),d={};if(e=p.getContext("webgl")||p.getContext("experimental-webgl"),!e)throw"Couldn't get WebGL context";this.addFilter=function(t){var e=Array.prototype.slice.call(arguments,1),i=I[t];s.push({func:i,args:e})},this.reset=function(){s=[]};var f=!1;this.apply=function(t){if(g(t.width,t.height),i=0,r||(r=e.createTexture()),e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),f?e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,t):(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),f=!0),0==s.length)return b(E.FRAGMENT_IDENTITY),y(),p;for(var a=0;a<s.length;a++){n=a==s.length-1;var o=s[a];o.func.apply(this,o.args||[])}return p};var g=function(t,i){if(t!=l||i!=c){if(p.width=l=t,p.height=c=i,!u){var r=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,-1,1,0,0,1,-1,1,1,1,1,1,0]);u=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)}e.viewport(0,0,l,c),o=[null,null]}},v=function(t){return o[t]=o[t]||m(l,c),o[t]},m=function(t,i){var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r);var n=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,n);var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),{fbo:r,texture:a}},y=function(t){var o=null,s=null,l=!1;o=0==i?r:v(a).texture,i++,!n||t&w.INTERMEDIATE?(a=(a+1)%2,s=v(a).fbo):(s=null,l=i%2==0),e.bindTexture(e.TEXTURE_2D,o),e.bindFramebuffer(e.FRAMEBUFFER,s),e.uniform1f(h.uniform.flipY,l?-1:1),e.drawArrays(e.TRIANGLES,0,6)},b=function(t){if(d[t])return h=d[t],e.useProgram(h.id),h;h=new x(e,E.VERTEX_IDENTITY,t);var i=Float32Array.BYTES_PER_ELEMENT,r=4*i;return e.enableVertexAttribArray(h.attribute.pos),e.vertexAttribPointer(h.attribute.pos,2,e.FLOAT,!1,r,0*i),e.enableVertexAttribArray(h.attribute.uv),e.vertexAttribPointer(h.attribute.uv,2,e.FLOAT,!1,r,2*i),d[t]=h,h},w={INTERMEDIATE:1},E={};E.VERTEX_IDENTITY=["precision highp float;","attribute vec2 pos;","attribute vec2 uv;","varying vec2 vUv;","uniform float flipY;","void main(void) {","vUv = uv;","gl_Position = vec4(pos.x, pos.y*flipY, 0.0, 1.);","}"].join("\n"),E.FRAGMENT_IDENTITY=["precision highp float;","varying vec2 vUv;","uniform sampler2D texture;","void main(void) {","gl_FragColor = texture2D(texture, vUv);","}"].join("\n");var I={colorMatrix:function(t){var i=new Float32Array(t);i[4]/=255,i[9]/=255,i[14]/=255,i[19]/=255;var r=1==i[18]&&0==i[3]&&0==i[8]&&0==i[13]&&0==i[15]&&0==i[16]&&0==i[17]&&0==i[19]?I.colorMatrix.SHADER.WITHOUT_ALPHA:I.colorMatrix.SHADER.WITH_ALPHA,n=b(r);e.uniform1fv(n.uniform.m,i),y()}};I.colorMatrix.SHADER={},I.colorMatrix.SHADER.WITH_ALPHA=["precision highp float;","varying vec2 vUv;","uniform sampler2D texture;","uniform float m[20];","void main(void) {","vec4 c = texture2D(texture, vUv);","gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[3] * c.a + m[4];","gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[8] * c.a + m[9];","gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[13] * c.a + m[14];","gl_FragColor.a = m[15] * c.r + m[16] * c.g + m[17] * c.b + m[18] * c.a + m[19];","}"].join("\n"),I.colorMatrix.SHADER.WITHOUT_ALPHA=["precision highp float;","varying vec2 vUv;","uniform sampler2D texture;","uniform float m[20];","void main(void) {","vec4 c = texture2D(texture, vUv);","gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[4];","gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[9];","gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[14];","gl_FragColor.a = c.a;","}"].join("\n"),I.brightness=function(t){var e=(t||0)+1;I.colorMatrix([e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0])},I.saturation=function(t){var e=2*(t||0)/3+1,i=-.5*(e-1);I.colorMatrix([e,i,i,0,0,i,e,i,0,0,i,i,e,0,0,0,0,0,1,0])},I.desaturate=function(){I.saturation(-1)},I.contrast=function(t){var e=(t||0)+1,i=-128*(e-1);I.colorMatrix([e,0,0,0,i,0,e,0,0,i,0,0,e,0,i,0,0,0,1,0])},I.negative=function(){I.contrast(-2)},I.hue=function(t){t=(t||0)/180*Math.PI;var e=Math.cos(t),i=Math.sin(t),r=.213,n=.715,a=.072;I.colorMatrix([r+e*(1-r)+i*-r,n+e*-n+i*-n,a+e*-a+i*(1-a),0,0,r+e*-r+.143*i,n+e*(1-n)+.14*i,a+e*-a+-.283*i,0,0,r+e*-r+i*-(1-r),n+e*-n+i*n,a+e*(1-a)+i*a,0,0,0,0,0,1,0])},I.desaturateLuminance=function(){I.colorMatrix([.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0])},I.sepia=function(){I.colorMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0])},I.brownie=function(){I.colorMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0])},I.vintagePinhole=function(){I.colorMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0])},I.kodachrome=function(){I.colorMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0])},I.technicolor=function(){I.colorMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0])},I.polaroid=function(){I.colorMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0])},I.shiftToBGR=function(){I.colorMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0])},I.convolution=function(t){var i=new Float32Array(t),r=1/l,n=1/c,a=b(I.convolution.SHADER);e.uniform1fv(a.uniform.m,i),e.uniform2f(a.uniform.px,r,n),y()},I.convolution.SHADER=["precision highp float;","varying vec2 vUv;","uniform sampler2D texture;","uniform vec2 px;","uniform float m[9];","void main(void) {","vec4 c11 = texture2D(texture, vUv - px);","vec4 c12 = texture2D(texture, vec2(vUv.x, vUv.y - px.y));","vec4 c13 = texture2D(texture, vec2(vUv.x + px.x, vUv.y - px.y));","vec4 c21 = texture2D(texture, vec2(vUv.x - px.x, vUv.y) );","vec4 c22 = texture2D(texture, vUv);","vec4 c23 = texture2D(texture, vec2(vUv.x + px.x, vUv.y) );","vec4 c31 = texture2D(texture, vec2(vUv.x - px.x, vUv.y + px.y) );","vec4 c32 = texture2D(texture, vec2(vUv.x, vUv.y + px.y) );","vec4 c33 = texture2D(texture, vUv + px );","gl_FragColor = ","c11 * m[0] + c12 * m[1] + c22 * m[2] +","c21 * m[3] + c22 * m[4] + c23 * m[5] +","c31 * m[6] + c32 * m[7] + c33 * m[8];","gl_FragColor.a = c22.a;","}"].join("\n"),I.detectEdges=function(){I.convolution.call(this,[0,1,0,1,-4,1,0,1,0])},I.sobelX=function(){I.convolution.call(this,[-1,0,1,-2,0,2,-1,0,1])},I.sobelY=function(){I.convolution.call(this,[-1,-2,-1,0,0,0,1,2,1])},I.sharpen=function(t){var e=t||1;I.convolution.call(this,[0,-1*e,0,-1*e,1+4*e,-1*e,0,-1*e,0])},I.emboss=function(t){var e=t||1;I.convolution.call(this,[-2*e,-1*e,0,-1*e,1,1*e,0,1*e,2*e])},I.blur=function(t){var i=t/7/l,r=t/7/c,n=b(I.blur.SHADER);e.uniform2f(n.uniform.px,0,r),y(w.INTERMEDIATE),e.uniform2f(n.uniform.px,i,0),y()},I.blur.SHADER=["precision highp float;","varying vec2 vUv;","uniform sampler2D texture;","uniform vec2 px;","void main(void) {","gl_FragColor = vec4(0.0);","gl_FragColor += texture2D(texture, vUv + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;","gl_FragColor += texture2D(texture, vUv + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;","gl_FragColor += texture2D(texture, vUv + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;","gl_FragColor += texture2D(texture, vUv + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;","gl_FragColor += texture2D(texture, vUv + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;","gl_FragColor += texture2D(texture, vUv + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;","gl_FragColor += texture2D(texture, vUv + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;","gl_FragColor += texture2D(texture, vUv                             )*0.159576912161;","gl_FragColor += texture2D(texture, vUv + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;","gl_FragColor += texture2D(texture, vUv + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;","gl_FragColor += texture2D(texture, vUv + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;","gl_FragColor += texture2D(texture, vUv + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;","gl_FragColor += texture2D(texture, vUv + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;","gl_FragColor += texture2D(texture, vUv + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;","gl_FragColor += texture2D(texture, vUv + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;","}"].join("\n"),I.pixelate=function(t){var i=t/l,r=t/c,n=b(I.pixelate.SHADER);e.uniform2f(n.uniform.size,i,r),y()},I.pixelate.SHADER=["precision highp float;","varying vec2 vUv;","uniform vec2 size;","uniform sampler2D texture;","vec2 pixelate(vec2 coord, vec2 size) {","return floor( coord / size ) * size;","}","void main(void) {","gl_FragColor = vec4(0.0);","vec2 coord = pixelate(vUv, size);","gl_FragColor += texture2D(texture, coord);","}"].join("\n")},b=i("bc3a"),w=i.n(b),E=w.a.CancelToken,I={name:"App",components:{SimpleKeyboard:f},data:function(){return{mode:"text",isVideoNeeded:!1,pageIndex:0,isInputting:!1,textSvgObj:null,textObj:null,textWidth:0,textHeight:0,input:"",drawingInput:"",defaultInput:"LENOVO",count:4,videoObj:null,maxHeight:500,xmlDoc:null,cancelAjax:null,screenshots:[],isLoading:!1,timestamp:"",shape:"rect",shapeList:["circle","rect","tri"],isBtn1Show:!1}},methods:{firstPageAni:function(t){var e=this,i=t.target;setTimeout((function(){i.src="/picture/btn01@x3.png"}),50),setTimeout((function(){i.src="/picture/btn00@x3.png",e.next(t)}),200)},next:function(t){var e=this;if(4!=this.pageIndex)switch(document.getElementById("button-audio").play(),this.pageIndex+=1,this.pageIndex>=6&&(this.pageIndex-=6),this.pageIndex){case 0:document.getElementById("paint").innerHTML="",document.getElementById("videoel").style.opacity=0,this.$nextTick((function(){document.getElementsByClassName("show0")[0].style.opacity=0,document.getElementsByClassName("btn00")[0].style.opacity=1,document.getElementsByClassName("back-btn0")[0].style.display="none"})),this.input="";break;case 1:document.getElementById("videoel").play(),document.getElementById("videoel").style.opacity=1,setTimeout((function(){e.isBtn1Show=!0,document.getElementsByClassName("back-btn1234")[0].style.display="block",document.getElementsByClassName("btn01234")[0].style.opacity=0}),600);break;case 2:var i=t.target;setTimeout((function(){i.src="/picture/btn1-pressed@x3.png"}),50),setTimeout((function(){i.src="/picture/btn2@x3.png",e.isBtn1Show=!1}),200),this.takePhoto();break;case 3:break;case 4:if("shape"==this.mode){var r=this.drawPhoto();this.getSvg(r)}var n=t.target;setTimeout((function(){n.src="/picture/btn3-pressed@x3.png"}),50),setTimeout((function(){n.src="/picture/btn4@x3.png"}),200),null==this.xmlDoc&&(this.isLoading=!0),this.drawSvg();break;case 5:break}},back:function(t){var e=t.target;if(setTimeout((function(){e.src="/picture/back-pressed@x3.png"}),50),setTimeout((function(){e.src="/picture/back-normal@x3.png"}),200),document.getElementById("button-audio").play(),2!=this.pageIndex&&4!=this.pageIndex)switch(this.pageIndex-=1,2==this.pageIndex&&(this.pageIndex-=1),this.pageIndex){case 0:document.getElementById("paint").innerHTML="",document.getElementById("videoel").style.opacity=0,this.isBtn1Show=!1,document.getElementsByClassName("back-btn1234")[0].style.display="none",document.getElementsByClassName("btn01234")[0].style.opacity=1,this.$nextTick((function(){document.getElementsByClassName("show0")[0].style.opacity=0,document.getElementsByClassName("btn00")[0].style.opacity=1})),this.input="";break;case 1:this.input="",this.isBtn1Show=!0,document.getElementById("videoel").play(),document.getElementById("videoel").style.opacity=1,null!=this.xmlDoc&&(this.xmlDoc=null);break;case 2:break;case 3:break}},takePhoto:function(){var t=this;this.count=3,document.getElementById("count-audio").play();var e=setInterval((function(){if(document.getElementById("count-audio").play(),t.count-=1,t.count<=0){var i=document.getElementById("overlay");if(i.style.display="block",document.getElementById("shoot-audio").play(),setTimeout((function(){i.style.display="none"}),500),clearInterval(e),t.count=4,t.videoObj.pause(),"text"==t.mode){var r=t.drawPhoto();t.getSvg(r)}t.next()}}),1e3)},getCollectionAndCallback:function(t){var e={textRect:{collection:this.xmlDoc.getElementsByTagName("rect"),addShape:this.addTextRect},rect:{collection:this.xmlDoc.getElementsByTagName("polygon"),addShape:this.addRotatedRect},circle:{collection:this.xmlDoc.getElementsByTagName("g"),addShape:this.addRotatedEllipse},tri:{collection:this.xmlDoc.getElementsByTagName("polygon"),addShape:this.addTri}};return e[t]},drawSvg:function(){var t=this,e=18;if(null!=this.xmlDoc){this.isLoading=!1,console.log(this.xmlDoc);var i=this.getCollectionAndCallback(this.shape),r=i.collection,n=i.addShape,a=Object(m["a"])().addTo("#paint").size("100%","100%");a.attr("id","draw"),document.getElementById("videoel").style.opacity=0,r.forEach((function(i,o){setTimeout((function(){o%8==0&&t.addFrame(o/8,o/r.length),document.querySelector(".show1234").style.opacity=o/r.length,n(a,r,o)}),e*o)})),setTimeout((function(){var e=new Date,i=function(t){return 2==t.length?t:"0"+t};t.timestamp=i(e.getHours().toString())+i(e.getMinutes().toString())+i(e.getSeconds().toString()),t.isVideoNeeded&&t.postImages(),t.makeCode(),t.postPoster(),t.pageIndex+=1,t.$nextTick((function(){document.getElementsByClassName("back-btn5")[0].style.display="none"}))}),e*r.length),this.xmlDoc=null}else setTimeout((function(){t.drawSvg()}),500)},addFrame:function(t,e){var i=this,r=document.getElementById("draw").outerHTML,n=document.getElementById("drawFrame"),a=n.getContext("2d"),o=document.createElement("img");o.width=862,o.height=1150,o.onload=function(){n.width=o.width,n.height=o.height,a.clearRect(0,0,n.width,n.height),0!=t&&(a.globalAlpha=e,a.drawImage(document.getElementById("canvasCopy"),0,0,n.width,n.height),a.globalAlpha=1),a.drawImage(o,0,0),i.screenshots[t]=n.toDataURL("image/png")},o.onerror=function(){n.width=o.width,n.height=o.height,a.clearRect(0,0,n.width,n.height),a.translate(862,0),a.scale(-1,1),0!=t&&(a.globalAlpha=e,a.drawImage(document.getElementById("canvasCopy"),0,0,n.width,n.height),a.globalAlpha=1),a.drawImage(o,0,0),i.screenshots[t]=n.toDataURL("image/png")},o.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(r)))},postImages:function(){var t=this,e=this.screenshots,i={url:"http://localhost:3000/make-video",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify({data:e,timestamp:this.timestamp})};w()(i).then((function(e){console.log(e),t.screenshots=[]}))},postPoster:function(){var t=document.getElementById("sharePoster"),e=t.getContext("2d"),i=document.getElementById("shareBg"),r=document.getElementById("drawFrame");document.getElementById("shareQrcode");e.drawImage(i,0,0,1080,1920,0,0,1080,1920),e.drawImage(r,0,0,862,1150,0,45,1080,1440);var n={url:"http://localhost:3000/poster",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify({data:t.toDataURL("image/png"),timestamp:this.timestamp})};w()(n).then((function(t){console.log(t)}))},mulRatio:function(t,e){var i=0,r=0,n=0,a=0,o=0,s=10;while(" "!=t[s])i+=t[s],s++;s++;while(")"!=t[s])r+=t[s],s++;s+=9;while(")"!=t[s])n+=t[s],s++;s+=8;while(" "!=t[s])a+=t[s],s++;s++;while(")"!=t[s])o+=t[s],s++;return i=parseInt(i)*e,r=parseInt(r)*e,a=parseInt(a)*e,o=parseInt(o)*e,"translate("+i+" "+r+") rotate("+n+") scale("+a+" "+o+")"},addTextRect:function(t,e,i){var r=parseFloat(e[i].attributes.x.value),n=parseFloat(e[i].attributes.y.value),a=parseFloat(e[i].attributes.width.value),o=parseFloat(e[i].attributes.height.value),s=e[i].attributes.fill.value,l=(e[i].attributes["fill-opacity"].value,e.length),c=a/this.textWidth,u=o/this.textHeight,h=a/this.textHeight,p=o/this.textWidth,d=1150/this.maxHeight;r*=d,n*=d,a*=d,o*=d,c*=d,h*=d,u*=d,p*=d;var f=t.rect({width:a,height:o,x:r,y:n});f.attr("id","rect"+i),f.attr("fill-rule","nonzero");var g=t.group();g.attr("id","rect"+i),g.attr("fill-rule","nonzero"),f.attr("fill",s),f.attr("fill-opacity",.1),g.attr("fill",s),g.attr("fill-opacity",.4+i/l/5);var v=this.textObj.text();g.plain(v),g.attr("font-size","100px"),g.attr("font-weight","bold"),g.attr("font-family","fantasy"),a>o?g.attr("transform","translate("+r+","+(n+.82*o)+") scale("+c+","+u+")"):g.attr("transform","translate("+r+","+n+") scale("+h+","+p+") rotate(90)")},addRect:function(t,e,i){var r=parseFloat(e[i].attributes.x.value),n=parseFloat(e[i].attributes.y.value),a=parseFloat(e[i].attributes.width.value),o=parseFloat(e[i].attributes.height.value),s=e[i].attributes.fill.value,l=1150/this.maxHeight;r*=l,n*=l,a*=l,o*=l;var c=t.rect({width:a,height:o,x:r,y:n});c.attr("id","rect"+i),c.attr("fill-rule","nonzero"),c.attr("fill",s),c.attr("fill-opacity",.5)},addRotatedRect:function(t,e,i){var r=1150/this.maxHeight,n="",a=e[i].attributes.points.value.split(" ");for(var o in a)n+=r*parseFloat(a[o]),n+=" ";var s=e[i].attributes.fill.value,l=t.polygon(n);l.attr("id","rect"+i),l.attr("fill-rule","nonzero"),l.attr("fill",s),l.attr("fill-opacity",.5)},addCircle:function(t,e,i){var r=parseFloat(e[i].attributes.cx.value),n=parseFloat(e[i].attributes.cy.value),a=parseFloat(e[i].attributes.r.value),o=e[i].attributes.fill.value,s=1150/this.maxHeight;r*=s,n*=s,a*=s;var l=t.circle({cx:r,cy:n,r:a});l.attr("id","circle"+i),l.attr("fill-rule","nonzero"),l.attr("fill",o),l.attr("fill-opacity",.5)},addRotatedEllipse:function(t,e,i){var r=0,n=0,a=1,o=1,s=e[i].firstChild.attributes.fill.value,l=e[i].attributes.transform.value,c=1150/this.maxHeight;l=this.mulRatio(l,c);var u=t.group();u.attr("transform",l);var h=u.ellipse({cx:r,cy:n,rx:a,ry:o});h.attr("id","r_ellipse"+i),h.attr("fill-rule","nonzero"),h.attr("fill",s),h.attr("fill-opacity",.5)},addTri:function(t,e,i){var r=1150/this.maxHeight,n="",a=e[i].attributes.points.value.split(" ");for(var o in a){var s=a[o].split(",");n+=r*parseFloat(s[0]),n+=",",n+=r*parseFloat(s[1]),n+=" "}var l=e[i].attributes.fill.value,c=t.polygon(n);c.attr("id","rect"+i),c.attr("fill-rule","nonzero"),c.attr("fill",l),c.attr("fill-opacity",.5)},setVideoSrc:function(){var t=this,e={audio:!1,video:{width:810,height:1080}};navigator.mediaDevices.getUserMedia(e).then((function(e){t.videoObj.srcObject=e,t.videoObj.onloadedmetadata=function(e){t.videoObj.play()}})).catch((function(t){console.log(t.name+": "+t.message)}))},drawPhoto:function(){var t=this.videoObj.getBoundingClientRect(),e=t.width,i=t.height,r=this.maxHeight,n=this.maxHeight,a=e,o=i;(e>r||i>n)&&(e/i>1?(a=r,o=Math.round(r*(i/e))):(o=n,a=Math.round(n*(e/i))));var s=document.createElement("canvas"),l=s.getContext("2d");s.width=a,s.height=o,l.clearRect(0,0,a,o),l.translate(a,0),l.scale(-1,1),l.drawImage(this.videoObj,0,0,a,o);var c=null,u=document.getElementById("canvas");try{c=new y({canvas:u})}catch(h){console.log(h)}return c.addFilter("brightness",.2),c.addFilter("contrast",.3),c.addFilter("saturation",-.3),c.apply(s),document.getElementById("canvasCopy").src=u.toDataURL("image/png",1),u.toDataURL("image/png",1)},makeCode:function(){var t=document.getElementById("shareQrcode"),e="http://xiaohui.ai/other-upload/"+this.timestamp+".mp4";v.a.toCanvas(t,e,(function(t){t&&console.error(t)}))},xmlParse:function(t){var e=null,i=null;try{e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)}catch(r){try{i=new DOMParser,e=i.parseFromString(t,"text/xml")}catch(r){alert(r.message)}}return e},getSvg:function(t){var e=this,i=this,r={url:"http://localhost:3000/getsvg",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify({data:t,shape:i.shape}),cancelToken:new E((function(t){i.cancelAjax=t}))};w()(r).then((function(t){console.log(t),e.xmlDoc=e.xmlParse(t.data.data)}))},removeEmoji:function(t){return t.replace(/[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F]|[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF]|[0-9|*|#]\uFE0F\u20E3|[0-9|#]\u20E3|[\u203C-\u3299]\uFE0F\u200D|[\u203C-\u3299]\uFE0F|[\u2122-\u2B55]|\u303D|[\A9|\AE]\u3030|\uA9|\uAE|\u3030/gi,"")},sanitizeInput:function(t){var e=this.removeEmoji(t).trim();return e.length?e:this.defaultInput},onInputChange:function(t){this.input=this.removeEmoji(t.target.value),null==this.textObj?this.textObj=this.textSvgObj.text(this.drawingInput):(this.textObj.clear(),this.textObj.text(this.drawingInput));var e=this.textObj.node.getBoundingClientRect();this.textWidth=e.width,this.textHeight=e.height},setShape:function(t){var e=t.target.src.split("/"),i=e[e.length-1].split(".")[0];this.shape=i}},mounted:function(){this.videoObj=document.getElementById("videoel"),this.textSvgObj=Object(m["a"])().addTo("#inputTextSvg").size("100%","100%"),this.setVideoSrc(),"text"==this.mode&&(this.shape="textRect")},watch:{input:function(t){this.drawingInput=this.sanitizeInput(t)}}},T=I,_=(i("034f"),Object(p["a"])(T,n,a,!1,null,null,null)),D=_.exports;i("25f5"),i("8092");r["a"].prototype.$ajax=w.a,r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(D)}}).$mount("#app")},8092:function(t,e,i){var r;i("fb6a"),i("d3b7"),i("ac1f"),i("466d"),i("38cf"),i("5319"),i("4a9b"),i("143c"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),function t(e,i,n){function a(s,l){if(!i[s]){if(!e[s]){var c="function"==typeof r&&r;if(!l&&c)return r(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[s]={exports:{}};e[s][0].call(h.exports,(function(t){var i=e[s][1][t];return a(i||t)}),h,h.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof r&&r,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(t,e,i){var r=t("./TypedNeuQuant.js"),n=t("./LZWEncoder.js");function a(){this.page=-1,this.pages=[],this.newPage()}a.pageSize=4096,a.charMap={};for(var o=0;o<256;o++)a.charMap[o]=String.fromCharCode(o);function s(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new a}a.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(a.pageSize),this.cursor=0},a.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<a.pageSize;i++)t+=a.charMap[this.pages[e][i]];return t},a.prototype.writeByte=function(t){this.cursor>=a.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},a.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))},a.prototype.writeBytes=function(t,e,i){for(var r=i||t.length,n=e||0;n<r;n++)this.writeByte(t[n])},s.prototype.setDelay=function(t){this.delay=Math.round(t/10)},s.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},s.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},s.prototype.setRepeat=function(t){this.repeat=t},s.prototype.setTransparent=function(t){this.transparent=t},s.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},s.prototype.finish=function(){this.out.writeByte(59)},s.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},s.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},s.prototype.setGlobalPalette=function(t){this.globalPalette=t},s.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},s.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},s.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new r(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},s.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var i=0,r=0;r<e;r++){var n=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[n]=!0,this.indexedPixels[r]=n}},s.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var r=i[t],n=0,a=this.height,o=this.width,s=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var c=0;c<a;c++){e&&(l*=-1);for(var u=1==l?0:o-1,h=1==l?o:0;u!==h;u+=l){n=c*o+u;var p=3*n,d=s[p],f=s[p+1],g=s[p+2];p=this.findClosestRGB(d,f,g),this.usedEntry[p]=!0,this.indexedPixels[n]=p,p*=3;for(var v=this.colorTab[p],m=this.colorTab[p+1],x=this.colorTab[p+2],y=d-v,b=f-m,w=g-x,E=1==l?0:r.length-1,I=1==l?r.length:0;E!==I;E+=l){var T=r[E][1],_=r[E][2];if(T+u>=0&&T+u<o&&_+c>=0&&_+c<a){var D=r[E][0];p=n+T+_*o,p*=3,s[p]=Math.max(0,Math.min(255,s[p]+y*D)),s[p+1]=Math.max(0,Math.min(255,s[p+1]+b*D)),s[p+2]=Math.max(0,Math.min(255,s[p+2]+w*D))}}}}},s.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},s.prototype.findClosestRGB=function(t,e,i,r){if(null===this.colorTab)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var n=0,a=16777216,o=this.colorTab.length,s=0,l=0;s<o;l++){var c=t-(255&this.colorTab[s++]),u=e-(255&this.colorTab[s++]),h=i-(255&this.colorTab[s++]),p=c*c+u*u+h*h;(!r||this.usedEntry[l])&&p<a&&(a=p,n=l)}return n},s.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,r=0,n=0,a=0;a<e;a++)for(var o=0;o<t;o++)this.pixels[n++]=i[r++],this.pixels[n++]=i[r++],this.pixels[n++]=i[r++],r++},s.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&dispose),e<<=2,this.out.writeByte(0|e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},s.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},s.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},s.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},s.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},s.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},s.prototype.writePixels=function(){var t=new n(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)},s.prototype.stream=function(){return this.out},e.exports=s},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(t,e,i){var r=-1,n=12,a=5003,o=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function s(t,e,i,s){var l,c,u,h,p,d,f=Math.max(2,s),g=new Uint8Array(256),v=new Int32Array(a),m=new Int32Array(a),x=0,y=0,b=!1;function w(t,e){g[c++]=t,c>=254&&D(e)}function E(t){I(a),y=p+2,b=!0,R(p,t)}function I(t){for(var e=0;e<t;++e)v[e]=-1}function T(t,e){var i,o,s,l,f,g,x;for(h=t,b=!1,n_bits=h,u=C(n_bits),p=1<<t-1,d=p+1,y=p+2,c=0,l=F(),x=0,i=a;i<65536;i*=2)++x;x=8-x,g=a,I(g),R(p,e);t:while((o=F())!=r)if(i=(o<<n)+l,s=o<<x^l,v[s]!==i){if(v[s]>=0){f=g-s,0===s&&(f=1);do{if((s-=f)<0&&(s+=g),v[s]===i){l=m[s];continue t}}while(v[s]>=0)}R(l,e),l=o,y<1<<n?(m[s]=y++,v[s]=i):E(e)}else l=m[s];R(l,e),R(d,e)}function _(i){i.writeByte(f),remaining=t*e,curPixel=0,T(f+1,i),i.writeByte(0)}function D(t){c>0&&(t.writeByte(c),t.writeBytes(g,0,c),c=0)}function C(t){return(1<<t)-1}function F(){if(0===remaining)return r;--remaining;var t=i[curPixel++];return 255&t}function R(t,e){l&=o[x],x>0?l|=t<<x:l=t,x+=n_bits;while(x>=8)w(255&l,e),l>>=8,x-=8;if((y>u||b)&&(b?(u=C(n_bits=h),b=!1):(++n_bits,u=n_bits==n?1<<n:C(n_bits))),t==d){while(x>0)w(255&l,e),l>>=8,x-=8;D(e)}}this.encode=_}e.exports=s},{}],3:[function(t,e,i){var r=100,n=256,a=n-1,o=4,s=16,l=1<<s,c=10,u=10,h=l>>u,p=l<<c-u,d=n>>3,f=6,g=1<<f,v=d*g,m=30,x=10,y=1<<x,b=8,w=1<<b,E=x+b,I=1<<E,T=499,_=491,D=487,C=503,F=3*C;function R(t,e){var i,d,g,x,b;function E(){var t,e;for(i=[],d=new Int32Array(256),g=new Int32Array(n),x=new Int32Array(n),b=new Int32Array(n>>3),t=0;t<n;t++)e=(t<<o+8)/n,i[t]=new Float64Array([e,e,e,0]),x[t]=l/n,g[t]=0}function R(){for(var t=0;t<n;t++)i[t][0]>>=o,i[t][1]>>=o,i[t][2]>>=o,i[t][3]=t}function P(t,e,r,n,a){i[e][0]-=t*(i[e][0]-r)/y,i[e][1]-=t*(i[e][1]-n)/y,i[e][2]-=t*(i[e][2]-a)/y}function S(t,e,r,a,o){var s,l,c=Math.abs(e-t),u=Math.min(e+t,n),h=e+1,p=e-1,d=1;while(h<u||p>c)l=b[d++],h<u&&(s=i[h++],s[0]-=l*(s[0]-r)/I,s[1]-=l*(s[1]-a)/I,s[2]-=l*(s[2]-o)/I),p>c&&(s=i[p--],s[0]-=l*(s[0]-r)/I,s[1]-=l*(s[1]-a)/I,s[2]-=l*(s[2]-o)/I)}function A(t,e,r){var a,l,d,f,v,m=~(1<<31),y=m,b=-1,w=b;for(a=0;a<n;a++)l=i[a],d=Math.abs(l[0]-t)+Math.abs(l[1]-e)+Math.abs(l[2]-r),d<m&&(m=d,b=a),f=d-(g[a]>>s-o),f<y&&(y=f,w=a),v=x[a]>>u,x[a]-=v,g[a]+=v<<c;return x[b]+=h,g[b]-=p,w}function B(){var t,e,r,o,s,l,c=0,u=0;for(t=0;t<n;t++){for(r=i[t],s=t,l=r[1],e=t+1;e<n;e++)o=i[e],o[1]<l&&(s=e,l=o[1]);if(o=i[s],t!=s&&(e=o[0],o[0]=r[0],r[0]=e,e=o[1],o[1]=r[1],r[1]=e,e=o[2],o[2]=r[2],r[2]=e,e=o[3],o[3]=r[3],r[3]=e),l!=c){for(d[c]=u+t>>1,e=c+1;e<l;e++)d[e]=t;c=l,u=t}}for(d[c]=u+a>>1,e=c+1;e<256;e++)d[e]=a}function U(t,e,r){var a,o,s,l=1e3,c=-1,u=d[e],h=u-1;while(u<n||h>=0)u<n&&(o=i[u],s=o[1]-e,s>=l?u=n:(u++,s<0&&(s=-s),a=o[0]-t,a<0&&(a=-a),s+=a,s<l&&(a=o[2]-r,a<0&&(a=-a),s+=a,s<l&&(l=s,c=o[3])))),h>=0&&(o=i[h],s=e-o[1],s>=l?h=-1:(h--,s<0&&(s=-s),a=o[0]-t,a<0&&(a=-a),s+=a,s<l&&(a=o[2]-r,a<0&&(a=-a),s+=a,s<l&&(l=s,c=o[3]))));return c}function k(){var i,n,a,s,l,c,u=t.length,h=30+(e-1)/3,p=u/(3*e),d=~~(p/r),g=y,x=v,E=x>>f;for(E<=1&&(E=0),i=0;i<E;i++)b[i]=g*((E*E-i*i)*w/(E*E));u<F?(e=1,n=3):n=u%T!==0?3*T:u%_!==0?3*_:u%D!==0?3*D:3*C;var I=0;i=0;while(i<p)if(a=(255&t[I])<<o,s=(255&t[I+1])<<o,l=(255&t[I+2])<<o,c=A(a,s,l),P(g,c,a,s,l),0!==E&&S(E,c,a,s,l),I+=n,I>=u&&(I-=u),i++,0===d&&(d=1),i%d===0)for(g-=g/h,x-=x/m,E=x>>f,E<=1&&(E=0),c=0;c<E;c++)b[c]=g*((E*E-c*c)*w/(E*E))}function L(){E(),k(),R(),B()}function M(){for(var t=[],e=[],r=0;r<n;r++)e[i[r][3]]=r;for(var a=0,o=0;o<n;o++){var s=e[o];t[a++]=i[s][0],t[a++]=i[s][1],t[a++]=i[s][2]}return t}this.buildColormap=L,this.getColormap=M,this.lookupRGB=U}e.exports=R},{}],4:[function(t,e,i){var r,n;r=t("./GIFEncoder.js"),n=function(t){var e,i,n,a;return e=new r(t.width,t.height),0===t.index?e.writeHeader():e.firstFrame=!1,e.setTransparent(t.transparent),e.setRepeat(t.repeat),e.setDelay(t.delay),e.setQuality(t.quality),e.setDither(t.dither),e.setGlobalPalette(t.globalPalette),e.addFrame(t.data),t.last&&e.finish(),!0===t.globalPalette&&(t.globalPalette=e.getGlobalPalette()),n=e.stream(),t.data=n.pages,t.cursor=n.cursor,t.pageSize=n.constructor.pageSize,t.canTransfer?(a=function(){var e,r,n,a;for(n=t.data,a=[],e=0,r=n.length;e<r;e++)i=n[e],a.push(i.buffer);return a}(),self.postMessage(t,a)):self.postMessage(t)},self.onmessage=function(t){return n(t.data)}},{"./GIFEncoder.js":1}]},{},[4])},"85ec":function(t,e,i){}});
//# sourceMappingURL=app.2f9c6bd9.js.map