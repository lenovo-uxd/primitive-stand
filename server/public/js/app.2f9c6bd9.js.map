{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?9b05","webpack:///node_modules/browser-pack/_prelude.js","webpack:///node_modules/events/events.js","webpack:///src/browser.coffee","webpack:///src/gif.coffee","webpack:///./src/App.vue?7f43","webpack:///./src/components/SimpleKeyboard.vue?6cac","webpack:///src/components/SimpleKeyboard.vue","webpack:///./src/components/SimpleKeyboard.vue?bb17","webpack:///./src/components/SimpleKeyboard.vue","webpack:///./src/lib/webgl-image-filter.js","webpack:///src/App.vue","webpack:///./src/App.vue?a7d1","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///src/GIFEncoder.js","webpack:///src/LZWEncoder.js","webpack:///src/TypedNeuQuant.js","webpack:///src/gif.worker.coffee"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","this","EventEmitter","isObject","er","err","handler","args","listeners","len","isFunction","listener","console","fired","g","list","position","ret","ua","navigator","userAgent","toLowerCase","platform","UA","match","document","documentMode","browser","version","parseFloat","parseInt","require","GIF","defaults","options","running","frames","freeWorkers","activeWorkers","setOptions","workerScript","workers","repeat","background","quality","width","height","transparent","debug","dither","frameDefaults","delay","copy","setOption","_canvas","addFrame","image","frame","ImageData","CanvasRenderingContext2D","WebGLRenderingContext","getContextData","context","Error","getImageData","render","nextFrame","finishedFrames","imageParts","results","numWorkers","spawnWorkers","globalPalette","renderNextFrame","emit","abort","worker","log","terminate","Math","min","forEach","Worker","_this","onmessage","event","indexOf","frameFinished","index","finishRendering","ref","pageSize","cursor","ref1","round","Uint8Array","offset","ref2","set","page","Blob","type","task","getTask","postMessage","ctx","createElement","getContext","setFill","fillRect","drawImage","last","canTransfer","_vm","_h","$createElement","_c","_self","attrs","staticStyle","class","pageIndex","domProps","staticClass","directives","rawName","expression","style","count","_e","input","on","onInputChange","$event","isInputting","_v","_l","item","shape","setShape","_s","timestamp","firstPageAni","back","next","isLoading","staticRenderFns","keyboardClass","props","default","String","mounted","keyboard","onChange","onKeyPress","methods","$emit","button","handleShift","layoutName","shiftToggle","watch","setInput","component","WebGLProgram","gl","vertexSource","fragmentSource","_collect","source","prefix","collection","RegExp","replace","_compile","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","uniform","attribute","_vsh","VERTEX_SHADER","_fsh","FRAGMENT_SHADER","a","id","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","getAttribLocation","u","getUniformLocation","WebGLImageFilter","params","_drawCount","_sourceTexture","_lastInChain","_currentFramebufferIndex","_tempFramebuffers","_filterChain","_width","_height","_vertexBuffer","_currentProgram","canvas","_shaderProgramCache","addFilter","Array","arguments","filter","_filter","func","reset","applied","_resize","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texSubImage2D","RGBA","UNSIGNED_BYTE","texImage2D","_compileShader","SHADER","FRAGMENT_IDENTITY","_draw","f","vertices","Float32Array","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","viewport","_getTempFramebuffer","_createFramebufferTexture","fbo","createFramebuffer","bindFramebuffer","FRAMEBUFFER","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","texture","LINEAR","framebufferTexture2D","COLOR_ATTACHMENT0","flags","target","flipY","DRAW","INTERMEDIATE","uniform1f","drawArrays","TRIANGLES","VERTEX_IDENTITY","floatSize","BYTES_PER_ELEMENT","vertSize","enableVertexAttribArray","pos","vertexAttribPointer","FLOAT","uv","join","matrix","colorMatrix","WITHOUT_ALPHA","WITH_ALPHA","program","uniform1fv","brightness","b","saturation","amount","x","y","desaturate","contrast","v","negative","hue","rotation","PI","cos","sin","lumR","lumG","lumB","desaturateLuminance","sepia","brownie","vintagePinhole","kodachrome","technicolor","polaroid","shiftToBGR","convolution","pixelSizeX","pixelSizeY","uniform2f","px","detectEdges","sobelX","sobelY","sharpen","emboss","size","blur","blurSizeX","blurSizeY","pixelate","components","SimpleKeyboard","isVideoNeeded","textSvgObj","textObj","textWidth","textHeight","drawingInput","defaultInput","videoObj","maxHeight","xmlDoc","cancelAjax","screenshots","shapeList","isBtn1Show","setTimeout","btn","src","getElementById","play","takePhoto","overlay","display","clearInterval","intervalId","getCollectionAndCallback","textRect","getElementsByTagName","addShape","addTextRect","rect","addRotatedRect","circle","addRotatedEllipse","tri","addTri","mapping","drawSvg","draw","attr","opacity","querySelector","getElementsByClassName","svg","outerHTML","img","onload","clearRect","globalAlpha","alpha","onerror","translate","scale","postImages","images","settings","url","method","timeout","headers","JSON","stringify","res","postPoster","shareBg","lastFrame","sharePoster","toDataURL","mulRatio","str","translateX","translateY","rotate","scaleX","scaleY","ratio","ratio1_h","ratio1_v","ratio2_h","ratio2_v","group","fill","plain","text","addRect","pointsStr","points","point","polygon","addCircle","cx","cy","transform","rx","ry","re","setVideoSrc","constraints","mediaDevices","drawPhoto","vid_width","maxWidth","vid_height","targetWidth","targetHeight","filteredCanvas","makeCode","error","xmlParse","ActiveXObject","async","loadXML","parser","DOMParser","parseFromString","alert","e","message","getSvg","cancelToken","CancelToken","removeEmoji","sanitizeInput","sanitized","clear","Vue","$ajax","axios","config","productionTip","h","App","$mount","ByteArray","rv","GIFEncoder","FalseFloydSteinberg","FloydSteinberg","Stucki","Atkinson","idx","dmin","minpos","srcPos","transp","disp","enc","accum","cl_hash","free_ent","clear_flg","output","g_init_bits","n_bits","maxcode","ClearCode","EOFCode","a_count","ent","hshift","hsize_reg","outer_loop","fcode","htab","codetab","cl_block","outs","remaining","curPixel","compress","cur_accum","cur_bits","char_out","flush_char","network","netindex","bias","freq","radpower","dist","bestd","bestpos","biasdist","bestbiasd","bestbiaspos","betafreq","smallpos","smallval","q","previouscol","startpos","best","samplefac","step","altersingle","pix","radius","rad","init","learn","unbiasnet","inxbuild","map","renderFrame","encoder","writeHeader","firstFrame","setTransparent","setRepeat","setDelay","setQuality","setDither","setGlobalPalette","finish","getGlobalPalette","stream","pages","constructor","transfer","buffer","self"],"mappings":"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,mBAEAA,oBAOAkd,8BACAld,wBAUAkd,mCACA,WACAld,eAYAkd,mCACA,4BACAld,eAQAkd,yCACAld,sBAQAkd,wCACA,sGAMAA,mCACAld,kCAMAkd,qCACA,gBACAld,6CACAA,8BACAA,2CAIA,YACAA,iGAEAA,mBAGAA,iBACAA,kBACAA,eAGA,0BACAA,wDAOAkd,oCACA,2BACAld,qCAEA,IADA,QACA,aACA,0BACAA,qBACAA,qBACAA,sBAEAA,qBACAA,0BAOAkd,uCACA,OACAC,sBACA,UACA,UACA,UAEAC,iBACA,WACA,YACA,WACA,WAEAC,SACA,WACA,WACA,YACA,YACA,WACA,WACA,WACA,YACA,YACA,WACA,WACA,WAEAC,WACA,UACA,UACA,WACA,UACA,UACA,WAIA,aACA,oCAGA,WACA,IACAza,cACAD,aACAzG,cACA,SAEA6D,wDAEA,qBAEA,WAEA,4CAEAuF,QAEA,UACA,OACA,SACA,SAGAgY,6BACAvd,qBACAA,wBACAud,KASA,IARA,uBACA,qBACA,qBAEA,MACA,MACA,MAEA,kDACA,cACA,UACA,iCACA,cACAA,UACAA,KAEAphB,wCACAA,4CACAA,iDAUA+gB,sCACA,mEAGAA,6CACA,iCAEA,qBACA,sCASA,IANA,IAEA,IACA,WACA,uBAEA,iBACA,iCACA,6BACA,6BACA,gBACA,6BACAM,IACAC,KAIA,UAOAP,sCACA,iBACA,cACAld,kCAMA,IAJA,iBACA,IACA,IAEA,YACA,oBACAA,wBACAA,wBACAA,wBACA0d,KAQAR,2CAKA,QAJAld,uBACAA,wBACAA,sBAGA,yBACA2d,IACAC,MAEAD,IACAC,KAGA,kBACAA,aAEAA,MAGA5d,mBACA,EACA4d,EAEAD,GAGA3d,4BACAA,oCACAA,uBAMAkd,sCACAld,uBACAA,mBACAA,mBACAA,4BACAA,6BAGA,oCAEAA,sBAGAA,mBACA,IAIAA,eAQAkd,gCAEAld,4BACAA,6BAGAA,mBACA,IAGAA,cAGAA,sBACAA,uBAMAkd,wCACAld,uBACAA,wBACAA,uBACAA,sCACAA,sBACAA,sBACAA,6BACAA,uBAMAkd,oCACAld,mCAEA,IADA,+BACA,YACAA,uBAGAkd,mCACAld,0BACAA,8BAMAkd,mCACA,uEACAW,oBAMAX,8BACA,iBAGAhf,8ECnhBA,SACA,KACA,OACA,iBACA,yBACA,6BAEA,oBACA,IAMA,EACA,EAEA,EAiBA,MA1BA,gBAEA,sBACA,oBACA,oBAEA,IAEA,IAKA,KAiBA,gBACA4f,SACA,aAKA,cACAC,KACAC,MACAC,KACAC,OAIA,cACA,4BAGA,gBACA,kBAmBA,IAhBAC,IAGAF,KACAG,SACAC,YAEAC,SACAC,MACAP,MAEAQ,IAEAC,MAEAC,IACA,qBACAA,MACAC,IACAZ,KAEAG,OAEAU,mBAGA,GAFAC,WACApiB,SACA,UAGA,YACAmhB,MACA,aACA,GAEA,IADA,gBACA,UACAa,OACA,kBAEAK,SAEAZ,OACAO,IACA,QACAM,SACAD,QAEAE,UAnBAP,OAwBAP,OACAA,OAGA,cACAe,eACAC,cACAC,WACAC,SACAH,eAIA,cACA,MACAA,eACAA,oBACAT,KAIA,cACA,eAIA,aACA,4BACAU,UACA,oBACA,aAGA,gBACAG,QAEA,YACAA,IAEAC,UAEA,WACAC,WACAF,MACAC,KAgBA,IAXA,UACA,GACAjB,cACAJ,SAEAG,OACA,iBACAC,YAIA,MAEA,UACAkB,WACAF,MACAC,KAEAE,MAIAxf,cAGA9B,oCCzLA,UACA,MACA,MAGA,IACA,KACA,OACA,KAEA,KACA,OACA,SAGA,OACA,IACA,OACA,MACA,KAGA,KACA,OAIA,IACA,OACA,MACA,OAIA,MACA,MACA,MACA,MACA,MAcA,gBACA,MACA,EAGA,EACA,EACA,EAOA,aAOA,QACA,IAPAuhB,KACAC,sBACAC,oBACAC,oBACAC,uBAGA,YACApN,aACAgN,iCAEAG,SACAD,OASA,aACA,oBACAF,YACAA,YACAA,YACAA,UASA,sBACAA,yBACAA,yBACAA,yBAQA,sBACA,IAOA,IAPA,gBACA,kBAEA,MACA,MACA,IAGA,eACA9T,SAEA,MACAhM,SACAA,mBACAA,mBACAA,oBAGA,MACAA,SACAA,mBACAA,mBACAA,oBAUA,kBAQA,IAKA,UALA,WACA,IACA,KACA,IAGA,gBACAH,OAEAsgB,qDACA,MACAC,IACAC,KAGAC,gBACA,MACAC,IACAC,KAGAC,UACAR,QACAD,WAMA,OAHAC,QACAD,QAEA,EAQA,aACA,wBACA,iBAKA,IAJAhgB,OACA0gB,IACAC,OAEA,cACAC,OACA,SACAF,IACAC,QAaA,GAVAC,OAEA,OACA5iB,wBACAA,wBACAA,wBACAA,yBAIA,MAEA,IADA+hB,YACA,cACAA,OACAc,IACAC,KAIA,IADAf,YACA,gBACAA,OAQA,kBACA,UAEA,MACA,KAEA,OACA,MAEA,gBACA,MACA/f,OACAmgB,SACA,UAEArjB,IACA,YACAkP,qBACAmU,KACA,MACAnU,qBACAmU,KACA,MACAC,IACAW,WAKA,OACA/gB,OACAmgB,SACA,WAEAniB,IACA,YACAgO,qBACAmU,KACA,MACAnU,qBACAmU,KACA,MACAC,IACAW,WAOA,SAQA,aACA,MAeA,EAcA,QA3BA,WACA,aACA,UACA,UACA,IACA,IAEA,OAGA,IADA,YACA,YACAb,2BAGA,KACAc,IACAC,KAEAA,EADA,QACAA,IACA,QACAA,IACA,QACAA,IAEAA,IAIA,QAEAnkB,IACA,UAgBA,GAfAyV,gBACArR,kBACAhC,kBAEAlB,WAEAkjB,aACA,oBAEAC,KACA,aAEArkB,IAEA,aACA,QAMA,IALAmb,OACAmJ,OACAC,OAEA,YACA,YACAnB,2BAaA,aACAoB,IACAC,IACAC,IACAC,IAeA,aAIA,IAHA,SACA,KAEA,YACA7b,aAGA,IADA,QACA,aACA,WACA8b,eACAA,eACAA,eAEA,SA3BArhB,qBA6BAA,mBAQAA,iBAGA9B,oCC9aA,IAAAgf,EAAA,EAAAA,EAAapb,EAAQ,mBAErBwf,EAAc,SAAC9d,GACb,IAAA+d,EAAA,MAuBA,OAvBAA,EAAc,IAAArE,EAAW1Z,EAAMZ,MAAOY,EAAMX,QAE1B,IAAfW,EAAM+B,MACPgc,EAAQC,cAERD,EAAQE,YAAa,EAEvBF,EAAQG,eAAele,EAAMV,aAC7Bye,EAAQI,UAAUne,EAAMf,QACxB8e,EAAQK,SAASpe,EAAMN,OACvBqe,EAAQM,WAAWre,EAAMb,SACzB4e,EAAQO,UAAUte,EAAMR,QACxBue,EAAQQ,iBAAiBve,EAAMe,eAC/Bgd,EAAQje,SAASE,EAAMrH,MACHqH,EAAMsD,MAA1Bya,EAAQS,UACkB,IAAvBxe,EAAMe,gBACPf,EAAMe,cAAgBgd,EAAQU,oBAEhCC,EAASX,EAAQW,SACjB1e,EAAMrH,KAAO+lB,EAAOC,MACpB3e,EAAMmC,OAASuc,EAAOvc,OACtBnC,EAAMkC,SAAWwc,EAAOE,YAAY1c,SAEjClC,EAAMuD,aACPsb,yBAAY5c,yDAAK6c,iBAAjBD,GACAE,KAAKhc,YAAY/C,EAAO6e,IAExBE,KAAKhc,YAAY/C,IAErB+e,KAAKpd,UAAY,SAACC,UAAUkc,EAAYlc,EAAMjJ,yC","file":"js/app.2f9c6bd9.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","### CoffeeScript version of the browser detection from MooTools ###\n\nua = navigator.userAgent.toLowerCase()\nplatform = navigator.platform.toLowerCase()\nUA = ua.match(/(opera|ie|firefox|chrome|version)[\\s\\/:]([\\w\\d\\.]+)?.*?(safari|version[\\s\\/:]([\\w\\d\\.]+)|$)/) or [null, 'unknown', 0]\nmode = UA[1] == 'ie' && document.documentMode\n\nbrowser =\n  name: if UA[1] is 'version' then UA[3] else UA[1]\n  version: mode or parseFloat(if UA[1] is 'opera' && UA[4] then UA[4] else UA[2])\n\n  platform:\n    name: if ua.match(/ip(?:ad|od|hone)/) then 'ios' else (ua.match(/(?:webos|android)/) or platform.match(/mac|win|linux/) or ['other'])[0]\n\nbrowser[browser.name] = true\nbrowser[browser.name + parseInt(browser.version, 10)] = true\nbrowser.platform[browser.platform.name] = true\n\nmodule.exports = browser\n","{EventEmitter} = require 'events'\nbrowser = require './browser.coffee'\n\nclass GIF extends EventEmitter\n\n  defaults =\n    workerScript: 'gif.worker.js'\n    workers: 2\n    repeat: 0 # repeat forever, -1 = repeat once\n    background: '#fff'\n    quality: 10 # pixel sample interval, lower is better\n    width: null # size derermined from first frame if possible\n    height: null\n    transparent: null\n    debug: false\n    dither: false # see GIFEncoder.js for dithering options\n\n  frameDefaults =\n    delay: 500 # ms\n    copy: false\n\n  constructor: (options) ->\n    @running = false\n\n    @options = {}\n    @frames = []\n\n    @freeWorkers = []\n    @activeWorkers = []\n\n    @setOptions options\n    for key, value of defaults\n      @options[key] ?= value\n\n  setOption: (key, value) ->\n    @options[key] = value\n    if @_canvas? and key in ['width', 'height']\n      @_canvas[key] = value\n\n  setOptions: (options) ->\n    @setOption key, value for own key, value of options\n\n  addFrame: (image, options={}) ->\n    frame = {}\n    frame.transparent = @options.transparent\n    for key of frameDefaults\n      frame[key] = options[key] or frameDefaults[key]\n\n    # use the images width and height for options unless already set\n    @setOption 'width', image.width unless @options.width?\n    @setOption 'height', image.height unless @options.height?\n\n    if ImageData? and image instanceof ImageData\n       frame.data = image.data\n    else if (CanvasRenderingContext2D? and image instanceof CanvasRenderingContext2D) or (WebGLRenderingContext? and image instanceof WebGLRenderingContext)\n      if options.copy\n        frame.data = @getContextData image\n      else\n        frame.context = image\n    else if image.childNodes?\n      if options.copy\n        frame.data = @getImageData image\n      else\n        frame.image = image\n    else\n      throw new Error 'Invalid image'\n\n    @frames.push frame\n\n  render: ->\n    throw new Error 'Already running' if @running\n\n    if not @options.width? or not @options.height?\n      throw new Error 'Width and height must be set prior to rendering'\n\n    @running = true\n    @nextFrame = 0\n    @finishedFrames = 0\n\n    @imageParts = (null for i in [0...@frames.length])\n    numWorkers = @spawnWorkers()\n    # we need to wait for the palette\n    if @options.globalPalette == true\n      @renderNextFrame()\n    else\n      @renderNextFrame() for i in [0...numWorkers]\n\n    @emit 'start'\n    @emit 'progress', 0\n\n  abort: ->\n    loop\n      worker = @activeWorkers.shift()\n      break unless worker?\n      @log 'killing active worker'\n      worker.terminate()\n    @running = false\n    @emit 'abort'\n\n  # private\n\n  spawnWorkers: ->\n    numWorkers = Math.min(@options.workers, @frames.length)\n    [@freeWorkers.length...numWorkers].forEach (i) =>\n      @log \"spawning worker #{ i }\"\n      worker = new Worker @options.workerScript\n      worker.onmessage = (event) =>\n        @activeWorkers.splice @activeWorkers.indexOf(worker), 1\n        @freeWorkers.push worker\n        @frameFinished event.data\n      @freeWorkers.push worker\n    return numWorkers\n\n  frameFinished: (frame) ->\n    @log \"frame #{ frame.index } finished - #{ @activeWorkers.length } active\"\n    @finishedFrames++\n    @emit 'progress', @finishedFrames / @frames.length\n    @imageParts[frame.index] = frame\n    # remember calculated palette, spawn the rest of the workers\n    if @options.globalPalette == true\n      @options.globalPalette = frame.globalPalette\n      @log 'global palette analyzed'\n      @renderNextFrame() for i in [1...@freeWorkers.length] if @frames.length > 2\n    if null in @imageParts\n      @renderNextFrame()\n    else\n      @finishRendering()\n\n  finishRendering: ->\n    len = 0\n    for frame in @imageParts\n      len += (frame.data.length - 1) * frame.pageSize + frame.cursor\n    len += frame.pageSize - frame.cursor\n    @log \"rendering finished - filesize #{ Math.round(len / 1000) }kb\"\n    data = new Uint8Array len\n    offset = 0\n    for frame in @imageParts\n      for page, i in frame.data\n        data.set page, offset\n        if i is frame.data.length - 1\n          offset += frame.cursor\n        else\n          offset += frame.pageSize\n\n    image = new Blob [data],\n      type: 'image/gif'\n\n    @emit 'finished', image, data\n\n  renderNextFrame: ->\n    throw new Error 'No free workers' if @freeWorkers.length is 0\n    return if @nextFrame >= @frames.length # no new frame to render\n\n    frame = @frames[@nextFrame++]\n    worker = @freeWorkers.shift()\n    task = @getTask frame\n\n    @log \"starting frame #{ task.index + 1 } of #{ @frames.length }\"\n    @activeWorkers.push worker\n    worker.postMessage task#, [task.data.buffer]\n\n  getContextData: (ctx) ->\n    return ctx.getImageData(0, 0, @options.width, @options.height).data\n\n  getImageData: (image) ->\n    if not @_canvas?\n      @_canvas = document.createElement 'canvas'\n      @_canvas.width = @options.width\n      @_canvas.height = @options.height\n\n    ctx = @_canvas.getContext '2d'\n    ctx.setFill = @options.background\n    ctx.fillRect 0, 0, @options.width, @options.height\n    ctx.drawImage image, 0, 0\n\n    return @getContextData ctx\n\n  getTask: (frame) ->\n    index = @frames.indexOf frame\n    task =\n      index: index\n      last: index is (@frames.length - 1)\n      delay: frame.delay\n      transparent: frame.transparent\n      width: @options.width\n      height: @options.height\n      quality: @options.quality\n      dither: @options.dither\n      globalPalette: @options.globalPalette\n      repeat: @options.repeat\n      canTransfer: (browser.name is 'chrome')\n\n    if frame.data?\n      task.data = frame.data\n    else if frame.context?\n      task.data = @getContextData frame.context\n    else if frame.image?\n      task.data = @getImageData frame.image\n    else\n      throw new Error 'Invalid frame'\n\n    return task\n\n  log: (args...) ->\n    return unless @options.debug\n    console.log args...\n\n\nmodule.exports = GIF\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('img',{staticStyle:{\"visibility\":\"hidden\",\"width\":\"1080px\",\"height\":\"1920px\"},attrs:{\"id\":\"shareBg\",\"src\":\"/picture/share-bg2.png\"}}),_c('canvas',{staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"drawFrame\"}}),_c('canvas',{staticStyle:{\"display\":\"none\",\"position\":\"fixed\",\"left\":\"0\",\"top\":\"0\"},attrs:{\"id\":\"sharePoster\",\"width\":\"1080\",\"height\":\"1920\"}}),_c('div',{attrs:{\"id\":\"inputTextSvg\",\"width\":\"80%\",\"height\":\"200px\"}}),_c('div',{class:_vm.pageIndex == 0 || _vm.pageIndex == 5 ? 'bg' + _vm.pageIndex : 'bg1234'}),_c('canvas',{class:_vm.pageIndex == 0 || _vm.pageIndex == 5 ? 'show' + _vm.pageIndex : 'show1234',attrs:{\"id\":\"canvas\",\"width\":\"1080px\",\"height\":\"1920px\"}}),_c('img',{attrs:{\"id\":\"canvasCopy\",\"src\":\"\"}}),_c('video',{class:_vm.pageIndex == 0 || _vm.pageIndex == 5 ? 'screen' + _vm.pageIndex : 'screen1234',attrs:{\"preload\":\"auto\",\"src\":\"/video/screen.mp4\",\"autoplay\":\"\",\"loop\":\"\",\"muted\":\"\"},domProps:{\"muted\":true}}),_c('video',{class:_vm.pageIndex == 0 || _vm.pageIndex == 5 ? 'video' + _vm.pageIndex : 'video1234',attrs:{\"id\":\"videoel\",\"preload\":\"auto\",\"autoPlay\":\"\"}}),_c('img',{staticClass:\"title\",attrs:{\"src\":'/picture/title' + _vm.pageIndex + '@x3.png',\"alt\":\"magic draw\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex >= 4),expression:\"pageIndex >= 4\"}],style:(_vm.pageIndex == 5\n        ? 'transform: scale(0.8); transform-origin: 50% 35%;'\n        : ''),attrs:{\"id\":\"paint\"}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 0),expression:\"pageIndex == 0\"}],staticClass:\"decor-bottom\",attrs:{\"src\":\"/picture/decor-bottom.png\"}}),_c('img',{class:_vm.pageIndex == 0 || _vm.pageIndex == 5 ? 'machine' + _vm.pageIndex : 'machine1234',attrs:{\"src\":\"/picture/machine@x3.png\",\"alt\":\"machine\"}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 0),expression:\"pageIndex == 0\"}],staticClass:\"decor-top\",attrs:{\"src\":\"/picture/decor-top.png\"}}),(_vm.count <= 3 && _vm.count >= 1)?_c('img',{staticClass:\"count\",attrs:{\"src\":'/picture/count' + _vm.count + '@x3.png'}}):_vm._e(),_c('div',{attrs:{\"id\":\"overlay\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.mode == 'text' && _vm.pageIndex == 3),expression:\"mode == 'text' && pageIndex == 3\"}],staticClass:\"input-container\"},[_c('input',{staticClass:\"input\",attrs:{\"id\":\"input\",\"placeholder\":\"点击输入名字\",\"autocomplete\":\"off\"},domProps:{\"value\":_vm.input},on:{\"input\":_vm.onInputChange,\"focus\":function($event){_vm.isInputting = true},\"blur\":function($event){_vm.isInputting = false}}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isInputting),expression:\"isInputting\"}],staticClass:\"finish-btn\",attrs:{\"src\":\"/picture/finishbtn.png\"}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.mode == 'shape' && _vm.pageIndex == 3),expression:\"mode == 'shape' && pageIndex == 3\"}],staticClass:\"shape-container\"},[_c('div',{staticClass:\"text\"},[_vm._v(\"请选择：\")]),_c('div',{staticClass:\"shapes\"},_vm._l((_vm.shapeList),function(item){return _c('img',{key:item,class:item == _vm.shape ? 'checked-shape' : 'shape',attrs:{\"src\":'/picture/' + item + '.png'},on:{\"click\":_vm.setShape}})}),0)]),_c('img',{class:_vm.pageIndex == 0 || _vm.pageIndex == 5\n        ? 'bottom-info' + _vm.pageIndex\n        : 'bottom-info1234',attrs:{\"src\":'/picture/infobottom' + _vm.pageIndex + '@x3.png',\"alt\":\"info bottom\"}}),_c('canvas',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 5),expression:\"pageIndex == 5\"}],attrs:{\"id\":\"shareQrcode\"}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 5),expression:\"pageIndex == 5\"}],attrs:{\"id\":\"qrcode\",\"src\":\"/picture/qrcode.jpg\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 5),expression:\"pageIndex == 5\"}],staticClass:\"timestamp\"},[_vm._v(_vm._s(_vm.timestamp))]),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex != 3),expression:\"pageIndex != 3\"}],class:_vm.pageIndex == 0 || _vm.pageIndex == 5 ? 'btn0' + _vm.pageIndex : 'btn01234',attrs:{\"src\":\"/picture/btn00@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.firstPageAni}}),_c('img',{class:_vm.pageIndex == 0 || _vm.pageIndex == 5\n        ? 'back-btn' + _vm.pageIndex\n        : 'back-btn1234',attrs:{\"src\":\"/picture/back-normal@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.back}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 0),expression:\"pageIndex == 0\"}],staticClass:\"btn0\",attrs:{\"src\":\"/picture/btn0@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.next}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isBtn1Show),expression:\"isBtn1Show\"}],staticClass:\"btn1234\",attrs:{\"src\":\"/picture/btn1@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.next}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 2),expression:\"pageIndex == 2\"}],staticClass:\"btn1234\",attrs:{\"src\":\"/picture/btn2@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.next}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 3),expression:\"pageIndex == 3\"}],staticClass:\"btn1234\",attrs:{\"src\":\"/picture/btn3@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.next}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 4),expression:\"pageIndex == 4\"}],staticClass:\"btn1234\",attrs:{\"src\":\"/picture/btn4@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.next}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.pageIndex == 5),expression:\"pageIndex == 5\"}],staticClass:\"btn5\",attrs:{\"src\":\"/picture/btn5@x3.png\",\"alt\":\"button\"},on:{\"click\":_vm.next}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isLoading && _vm.pageIndex == 4),expression:\"isLoading && pageIndex == 4\"}],staticClass:\"loading\",attrs:{\"src\":\"/picture/loading.gif\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(false),expression:\"false\"}]},[_c('audio',{attrs:{\"id\":\"button-audio\",\"src\":\"/audio/button.mp3\",\"preload\":\"\"}}),_c('audio',{attrs:{\"id\":\"count-audio\",\"src\":\"/audio/count.mp3\",\"preload\":\"\"}}),_c('audio',{attrs:{\"id\":\"keyboard-audio\",\"src\":\"/audio/keyboard.mp3\",\"preload\":\"\"}}),_c('audio',{attrs:{\"id\":\"shoot-audio\",\"src\":\"/audio/shoot.mp3\",\"preload\":\"\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:_vm.keyboardClass})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div :class=\"keyboardClass\"></div>\r\n</template>\r\n\r\n<script>\r\nimport Keyboard from \"simple-keyboard\";\r\nimport \"simple-keyboard/build/css/index.css\";\r\n\r\nexport default {\r\n  name: \"SimpleKeyboard\",\r\n  props: {\r\n    keyboardClass: {\r\n      default: \"simple-keyboard\",\r\n      type: String\r\n    },\r\n    input: {\r\n      type: String\r\n    }\r\n  },\r\n  data: () => ({\r\n    keyboard: null\r\n  }),\r\n  mounted() {\r\n    this.keyboard = new Keyboard({\r\n      onChange: this.onChange,\r\n      onKeyPress: this.onKeyPress\r\n    });\r\n  },\r\n  methods: {\r\n    onChange(input) {\r\n      this.$emit(\"onChange\", input);\r\n    },\r\n    onKeyPress(button) {\r\n      this.$emit(\"onKeyPress\", button);\r\n\r\n      /**\r\n       * If you want to handle the shift and caps lock buttons\r\n       */\r\n      if (button === \"{shift}\" || button === \"{lock}\") this.handleShift();\r\n    },\r\n    handleShift() {\r\n      let currentLayout = this.keyboard.options.layoutName;\r\n      let shiftToggle = currentLayout === \"default\" ? \"shift\" : \"default\";\r\n\r\n      this.keyboard.setOptions({\r\n        layoutName: shiftToggle\r\n      });\r\n    }\r\n  },\r\n  watch: {\r\n    input(input) {\r\n      this.keyboard.setInput(input);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleKeyboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleKeyboard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SimpleKeyboard.vue?vue&type=template&id=45ac0b00&scoped=true&\"\nimport script from \"./SimpleKeyboard.vue?vue&type=script&lang=js&\"\nexport * from \"./SimpleKeyboard.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"45ac0b00\",\n  null\n  \n)\n\nexport default component.exports","/* \r\nWebGLImageFilter - MIT Licensed\r\n\r\n2013, Dominic Szablewski - phoboslab.org\r\n*/\r\n\r\n// (function(window){\r\n\r\nvar WebGLProgram = function (gl, vertexSource, fragmentSource) {\r\n\r\n\tvar _collect = function (source, prefix, collection) {\r\n\t\tvar r = new RegExp('\\\\b' + prefix + ' \\\\w+ (\\\\w+)', 'ig');\r\n\t\tsource.replace(r, function (match, name) {\r\n\t\t\tcollection[name] = 0;\r\n\t\t\treturn match;\r\n\t\t});\r\n\t};\r\n\r\n\tvar _compile = function (gl, source, type) {\r\n\t\tvar shader = gl.createShader(type);\r\n\t\tgl.shaderSource(shader, source);\r\n\t\tgl.compileShader(shader);\r\n\r\n\t\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n\t\t\tconsole.log(gl.getShaderInfoLog(shader));\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn shader;\r\n\t};\r\n\r\n\r\n\tthis.uniform = {};\r\n\tthis.attribute = {};\r\n\r\n\tvar _vsh = _compile(gl, vertexSource, gl.VERTEX_SHADER);\r\n\tvar _fsh = _compile(gl, fragmentSource, gl.FRAGMENT_SHADER);\r\n\r\n\tthis.id = gl.createProgram();\r\n\tgl.attachShader(this.id, _vsh);\r\n\tgl.attachShader(this.id, _fsh);\r\n\tgl.linkProgram(this.id);\r\n\r\n\tif (!gl.getProgramParameter(this.id, gl.LINK_STATUS)) {\r\n\t\tconsole.log(gl.getProgramInfoLog(this.id));\r\n\t}\r\n\r\n\tgl.useProgram(this.id);\r\n\r\n\t// Collect attributes\r\n\t_collect(vertexSource, 'attribute', this.attribute);\r\n\tfor (var a in this.attribute) {\r\n\t\tthis.attribute[a] = gl.getAttribLocation(this.id, a);\r\n\t}\r\n\r\n\t// Collect uniforms\r\n\t_collect(vertexSource, 'uniform', this.uniform);\r\n\t_collect(fragmentSource, 'uniform', this.uniform);\r\n\tfor (var u in this.uniform) {\r\n\t\tthis.uniform[u] = gl.getUniformLocation(this.id, u);\r\n\t}\r\n};\r\n\r\n\r\nvar WebGLImageFilter = window.WebGLImageFilter = function (params) {\r\n\tif (!params)\r\n\t\tparams = {};\r\n\r\n\tvar\r\n\t\tgl = null,\r\n\t\t_drawCount = 0,\r\n\t\t_sourceTexture = null,\r\n\t\t_lastInChain = false,\r\n\t\t_currentFramebufferIndex = -1,\r\n\t\t_tempFramebuffers = [null, null],\r\n\t\t_filterChain = [],\r\n\t\t_width = -1,\r\n\t\t_height = -1,\r\n\t\t_vertexBuffer = null,\r\n\t\t_currentProgram = null,\r\n\t\t_canvas = params.canvas || document.createElement('canvas');\r\n\r\n\t// key is the shader program source, value is the compiled program\r\n\tvar _shaderProgramCache = {};\r\n\r\n\tgl = _canvas.getContext(\"webgl\") || _canvas.getContext(\"experimental-webgl\");\r\n\t// console.log(_canvas.getContext(\"webgl\"))\r\n\tif (!gl) {\r\n\t\t// console.log(gl)\r\n\t\tthrow \"Couldn't get WebGL context\";\r\n\t}\r\n\r\n\r\n\tthis.addFilter = function (name) {\r\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\t\tvar filter = _filter[name];\r\n\r\n\t\t_filterChain.push({ func: filter, args: args });\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\t\t_filterChain = [];\r\n\t};\r\n\r\n\tvar applied = false;\r\n\r\n\tthis.apply = function (image) {\r\n\t\t_resize(image.width, image.height);\r\n\t\t_drawCount = 0;\r\n\r\n\t\t// Create the texture for the input image if we haven't yet\r\n\t\tif (!_sourceTexture)\r\n\t\t\t_sourceTexture = gl.createTexture();\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, _sourceTexture);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n\t\tif (!applied) {\r\n\t\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n\t\t\tapplied = true;\r\n\t\t} else {\r\n\t\t\tgl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n\t\t}\r\n\r\n\t\t// No filters? Just draw\r\n\t\tif (_filterChain.length == 0) {\r\n\t\t\t// var program = _compileShader(SHADER.FRAGMENT_IDENTITY);\r\n\t\t\t_compileShader(SHADER.FRAGMENT_IDENTITY);\r\n\t\t\t_draw();\r\n\t\t\treturn _canvas;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < _filterChain.length; i++) {\r\n\t\t\t_lastInChain = (i == _filterChain.length - 1);\r\n\t\t\tvar f = _filterChain[i];\r\n\r\n\t\t\tf.func.apply(this, f.args || []);\r\n\t\t}\r\n\r\n\t\treturn _canvas;\r\n\t};\r\n\r\n\tvar _resize = function (width, height) {\r\n\t\t// Same width/height? Nothing to do here\r\n\t\tif (width == _width && height == _height) { return; }\r\n\r\n\r\n\t\t_canvas.width = _width = width;\r\n\t\t_canvas.height = _height = height;\r\n\r\n\t\t// Create the context if we don't have it yet\r\n\t\tif (!_vertexBuffer) {\r\n\t\t\t// Create the vertex buffer for the two triangles [x, y, u, v] * 6\r\n\t\t\tvar vertices = new Float32Array([\r\n\t\t\t\t-1, -1, 0, 1, 1, -1, 1, 1, -1, 1, 0, 0,\r\n\t\t\t\t-1, 1, 0, 0, 1, -1, 1, 1, 1, 1, 1, 0\r\n\t\t\t]);\r\n\t\t\t_vertexBuffer = gl.createBuffer(),\r\n\t\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, _vertexBuffer);\r\n\t\t\tgl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n\r\n\t\t\t// Note sure if this is a good idea; at least it makes texture loading\r\n\t\t\t// in Ejecta instant.\r\n\t\t\tgl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n\t\t}\r\n\r\n\t\tgl.viewport(0, 0, _width, _height);\r\n\r\n\t\t// Delete old temp framebuffers\r\n\t\t_tempFramebuffers = [null, null];\r\n\t};\r\n\r\n\tvar _getTempFramebuffer = function (index) {\r\n\t\t_tempFramebuffers[index] =\r\n\t\t\t_tempFramebuffers[index] ||\r\n\t\t\t_createFramebufferTexture(_width, _height);\r\n\r\n\t\treturn _tempFramebuffers[index];\r\n\t};\r\n\r\n\tvar _createFramebufferTexture = function (width, height) {\r\n\t\tvar fbo = gl.createFramebuffer();\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\r\n\r\n\t\tvar renderbuffer = gl.createRenderbuffer();\r\n\t\tgl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\r\n\r\n\t\tvar texture = gl.createTexture();\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\r\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\r\n\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n\r\n\t\treturn { fbo: fbo, texture: texture };\r\n\t};\r\n\r\n\tvar _draw = function (flags) {\r\n\t\tvar source = null,\r\n\t\t\ttarget = null,\r\n\t\t\tflipY = false;\r\n\r\n\t\t// Set up the source\r\n\t\tif (_drawCount == 0) {\r\n\t\t\t// First draw call - use the source texture\r\n\t\t\tsource = _sourceTexture;\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// All following draw calls use the temp buffer last drawn to\r\n\t\t\tsource = _getTempFramebuffer(_currentFramebufferIndex).texture;\r\n\t\t}\r\n\t\t_drawCount++;\r\n\r\n\r\n\t\t// Set up the target\r\n\t\tif (_lastInChain && !(flags & DRAW.INTERMEDIATE)) {\r\n\t\t\t// Last filter in our chain - draw directly to the WebGL Canvas. We may\r\n\t\t\t// also have to flip the image vertically now\r\n\t\t\ttarget = null;\r\n\t\t\tflipY = _drawCount % 2 == 0;\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Intermediate draw call - get a temp buffer to draw to\r\n\t\t\t_currentFramebufferIndex = (_currentFramebufferIndex + 1) % 2;\r\n\t\t\ttarget = _getTempFramebuffer(_currentFramebufferIndex).fbo;\r\n\t\t}\r\n\r\n\t\t// Bind the source and target and draw the two triangles\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, source);\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, target);\r\n\r\n\t\tgl.uniform1f(_currentProgram.uniform.flipY, (flipY ? -1 : 1));\r\n\t\tgl.drawArrays(gl.TRIANGLES, 0, 6);\r\n\t};\r\n\r\n\tvar _compileShader = function (fragmentSource) {\r\n\t\tif (_shaderProgramCache[fragmentSource]) {\r\n\t\t\t_currentProgram = _shaderProgramCache[fragmentSource];\r\n\t\t\tgl.useProgram(_currentProgram.id);\r\n\t\t\treturn _currentProgram;\r\n\t\t}\r\n\r\n\t\t// Compile shaders\r\n\t\t_currentProgram = new WebGLProgram(gl, SHADER.VERTEX_IDENTITY, fragmentSource);\r\n\r\n\t\tvar floatSize = Float32Array.BYTES_PER_ELEMENT;\r\n\t\tvar vertSize = 4 * floatSize;\r\n\t\tgl.enableVertexAttribArray(_currentProgram.attribute.pos);\r\n\t\tgl.vertexAttribPointer(_currentProgram.attribute.pos, 2, gl.FLOAT, false, vertSize, 0 * floatSize);\r\n\t\tgl.enableVertexAttribArray(_currentProgram.attribute.uv);\r\n\t\tgl.vertexAttribPointer(_currentProgram.attribute.uv, 2, gl.FLOAT, false, vertSize, 2 * floatSize);\r\n\r\n\t\t_shaderProgramCache[fragmentSource] = _currentProgram;\r\n\t\treturn _currentProgram;\r\n\t};\r\n\r\n\r\n\tvar DRAW = { INTERMEDIATE: 1 };\r\n\r\n\tvar SHADER = {};\r\n\tSHADER.VERTEX_IDENTITY = [\r\n\t\t'precision highp float;',\r\n\t\t'attribute vec2 pos;',\r\n\t\t'attribute vec2 uv;',\r\n\t\t'varying vec2 vUv;',\r\n\t\t'uniform float flipY;',\r\n\r\n\t\t'void main(void) {',\r\n\t\t'vUv = uv;',\r\n\t\t'gl_Position = vec4(pos.x, pos.y*flipY, 0.0, 1.);',\r\n\t\t'}'\r\n\t].join('\\n');\r\n\r\n\tSHADER.FRAGMENT_IDENTITY = [\r\n\t\t'precision highp float;',\r\n\t\t'varying vec2 vUv;',\r\n\t\t'uniform sampler2D texture;',\r\n\r\n\t\t'void main(void) {',\r\n\t\t'gl_FragColor = texture2D(texture, vUv);',\r\n\t\t'}',\r\n\t].join('\\n');\r\n\r\n\r\n\tvar _filter = {};\r\n\r\n\r\n\r\n\t// -------------------------------------------------------------------------\r\n\t// Color Matrix Filter\r\n\r\n\t_filter.colorMatrix = function (matrix) {\r\n\t\t// Create a Float32 Array and normalize the offset component to 0-1\r\n\t\tvar m = new Float32Array(matrix);\r\n\t\tm[4] /= 255;\r\n\t\tm[9] /= 255;\r\n\t\tm[14] /= 255;\r\n\t\tm[19] /= 255;\r\n\r\n\t\t// Can we ignore the alpha value? Makes things a bit faster.\r\n\t\tvar shader = (1 == m[18] && 0 == m[3] && 0 == m[8] && 0 == m[13] && 0 == m[15] && 0 == m[16] && 0 == m[17] && 0 == m[19])\r\n\t\t\t? _filter.colorMatrix.SHADER.WITHOUT_ALPHA\r\n\t\t\t: _filter.colorMatrix.SHADER.WITH_ALPHA;\r\n\r\n\t\tvar program = _compileShader(shader);\r\n\t\tgl.uniform1fv(program.uniform.m, m);\r\n\t\t_draw();\r\n\t};\r\n\r\n\t_filter.colorMatrix.SHADER = {};\r\n\t_filter.colorMatrix.SHADER.WITH_ALPHA = [\r\n\t\t'precision highp float;',\r\n\t\t'varying vec2 vUv;',\r\n\t\t'uniform sampler2D texture;',\r\n\t\t'uniform float m[20];',\r\n\r\n\t\t'void main(void) {',\r\n\t\t'vec4 c = texture2D(texture, vUv);',\r\n\t\t'gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[3] * c.a + m[4];',\r\n\t\t'gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[8] * c.a + m[9];',\r\n\t\t'gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[13] * c.a + m[14];',\r\n\t\t'gl_FragColor.a = m[15] * c.r + m[16] * c.g + m[17] * c.b + m[18] * c.a + m[19];',\r\n\t\t'}',\r\n\t].join('\\n');\r\n\t_filter.colorMatrix.SHADER.WITHOUT_ALPHA = [\r\n\t\t'precision highp float;',\r\n\t\t'varying vec2 vUv;',\r\n\t\t'uniform sampler2D texture;',\r\n\t\t'uniform float m[20];',\r\n\r\n\t\t'void main(void) {',\r\n\t\t'vec4 c = texture2D(texture, vUv);',\r\n\t\t'gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[4];',\r\n\t\t'gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[9];',\r\n\t\t'gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[14];',\r\n\t\t'gl_FragColor.a = c.a;',\r\n\t\t'}',\r\n\t].join('\\n');\r\n\r\n\t_filter.brightness = function (brightness) {\r\n\t\tvar b = (brightness || 0) + 1;\r\n\t\t_filter.colorMatrix([\r\n\t\t\tb, 0, 0, 0, 0,\r\n\t\t\t0, b, 0, 0, 0,\r\n\t\t\t0, 0, b, 0, 0,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.saturation = function (amount) {\r\n\t\tvar x = (amount || 0) * 2 / 3 + 1;\r\n\t\tvar y = ((x - 1) * -0.5);\r\n\t\t_filter.colorMatrix([\r\n\t\t\tx, y, y, 0, 0,\r\n\t\t\ty, x, y, 0, 0,\r\n\t\t\ty, y, x, 0, 0,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.desaturate = function () {\r\n\t\t_filter.saturation(-1);\r\n\t};\r\n\r\n\t_filter.contrast = function (amount) {\r\n\t\tvar v = (amount || 0) + 1;\r\n\t\tvar o = -128 * (v - 1);\r\n\r\n\t\t_filter.colorMatrix([\r\n\t\t\tv, 0, 0, 0, o,\r\n\t\t\t0, v, 0, 0, o,\r\n\t\t\t0, 0, v, 0, o,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.negative = function () {\r\n\t\t_filter.contrast(-2);\r\n\t};\r\n\r\n\t_filter.hue = function (rotation) {\r\n\t\trotation = (rotation || 0) / 180 * Math.PI;\r\n\t\tvar cos = Math.cos(rotation),\r\n\t\t\tsin = Math.sin(rotation),\r\n\t\t\tlumR = 0.213,\r\n\t\t\tlumG = 0.715,\r\n\t\t\tlumB = 0.072;\r\n\r\n\t\t_filter.colorMatrix([\r\n\t\t\tlumR + cos * (1 - lumR) + sin * (-lumR), lumG + cos * (-lumG) + sin * (-lumG), lumB + cos * (-lumB) + sin * (1 - lumB), 0, 0,\r\n\t\t\tlumR + cos * (-lumR) + sin * (0.143), lumG + cos * (1 - lumG) + sin * (0.140), lumB + cos * (-lumB) + sin * (-0.283), 0, 0,\r\n\t\t\tlumR + cos * (-lumR) + sin * (-(1 - lumR)), lumG + cos * (-lumG) + sin * (lumG), lumB + cos * (1 - lumB) + sin * (lumB), 0, 0,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.desaturateLuminance = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t0.2764723, 0.9297080, 0.0938197, 0, -37.1,\r\n\t\t\t0.2764723, 0.9297080, 0.0938197, 0, -37.1,\r\n\t\t\t0.2764723, 0.9297080, 0.0938197, 0, -37.1,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.sepia = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t0.393, 0.7689999, 0.18899999, 0, 0,\r\n\t\t\t0.349, 0.6859999, 0.16799999, 0, 0,\r\n\t\t\t0.272, 0.5339999, 0.13099999, 0, 0,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.brownie = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t0.5997023498159715, 0.34553243048391263, -0.2708298674538042, 0, 47.43192855600873,\r\n\t\t\t-0.037703249837783157, 0.8609577587992641, 0.15059552388459913, 0, -36.96841498319127,\r\n\t\t\t0.24113635128153335, -0.07441037908422492, 0.44972182064877153, 0, -7.562075277591283,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.vintagePinhole = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t0.6279345635605994, 0.3202183420819367, -0.03965408211312453, 0, 9.651285835294123,\r\n\t\t\t0.02578397704808868, 0.6441188644374771, 0.03259127616149294, 0, 7.462829176470591,\r\n\t\t\t0.0466055556782719, -0.0851232987247891, 0.5241648018700465, 0, 5.159190588235296,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.kodachrome = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t1.1285582396593525, -0.3967382283601348, -0.03992559172921793, 0, 63.72958762196502,\r\n\t\t\t-0.16404339962244616, 1.0835251566291304, -0.05498805115633132, 0, 24.732407896706203,\r\n\t\t\t-0.16786010706155763, -0.5603416277695248, 1.6014850761964943, 0, 35.62982807460946,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.technicolor = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t1.9125277891456083, -0.8545344976951645, -0.09155508482755585, 0, 11.793603434377337,\r\n\t\t\t-0.3087833385928097, 1.7658908555458428, -0.10601743074722245, 0, -70.35205161461398,\r\n\t\t\t-0.231103377548616, -0.7501899197440212, 1.847597816108189, 0, 30.950940869491138,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.polaroid = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t1.438, -0.062, -0.062, 0, 0,\r\n\t\t\t-0.122, 1.378, -0.122, 0, 0,\r\n\t\t\t-0.016, -0.016, 1.483, 0, 0,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.shiftToBGR = function () {\r\n\t\t_filter.colorMatrix([\r\n\t\t\t0, 0, 1, 0, 0,\r\n\t\t\t0, 1, 0, 0, 0,\r\n\t\t\t1, 0, 0, 0, 0,\r\n\t\t\t0, 0, 0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\r\n\t// -------------------------------------------------------------------------\r\n\t// Convolution Filter\r\n\r\n\t_filter.convolution = function (matrix) {\r\n\t\tvar m = new Float32Array(matrix);\r\n\t\tvar pixelSizeX = 1 / _width;\r\n\t\tvar pixelSizeY = 1 / _height;\r\n\r\n\t\tvar program = _compileShader(_filter.convolution.SHADER);\r\n\t\tgl.uniform1fv(program.uniform.m, m);\r\n\t\tgl.uniform2f(program.uniform.px, pixelSizeX, pixelSizeY);\r\n\t\t_draw();\r\n\t};\r\n\r\n\t_filter.convolution.SHADER = [\r\n\t\t'precision highp float;',\r\n\t\t'varying vec2 vUv;',\r\n\t\t'uniform sampler2D texture;',\r\n\t\t'uniform vec2 px;',\r\n\t\t'uniform float m[9];',\r\n\r\n\t\t'void main(void) {',\r\n\t\t'vec4 c11 = texture2D(texture, vUv - px);', // top left\r\n\t\t'vec4 c12 = texture2D(texture, vec2(vUv.x, vUv.y - px.y));', // top center\r\n\t\t'vec4 c13 = texture2D(texture, vec2(vUv.x + px.x, vUv.y - px.y));', // top right\r\n\r\n\t\t'vec4 c21 = texture2D(texture, vec2(vUv.x - px.x, vUv.y) );', // mid left\r\n\t\t'vec4 c22 = texture2D(texture, vUv);', // mid center\r\n\t\t'vec4 c23 = texture2D(texture, vec2(vUv.x + px.x, vUv.y) );', // mid right\r\n\r\n\t\t'vec4 c31 = texture2D(texture, vec2(vUv.x - px.x, vUv.y + px.y) );', // bottom left\r\n\t\t'vec4 c32 = texture2D(texture, vec2(vUv.x, vUv.y + px.y) );', // bottom center\r\n\t\t'vec4 c33 = texture2D(texture, vUv + px );', // bottom right\r\n\r\n\t\t'gl_FragColor = ',\r\n\t\t'c11 * m[0] + c12 * m[1] + c22 * m[2] +',\r\n\t\t'c21 * m[3] + c22 * m[4] + c23 * m[5] +',\r\n\t\t'c31 * m[6] + c32 * m[7] + c33 * m[8];',\r\n\t\t'gl_FragColor.a = c22.a;',\r\n\t\t'}',\r\n\t].join('\\n');\r\n\r\n\r\n\t_filter.detectEdges = function () {\r\n\t\t_filter.convolution.call(this, [\r\n\t\t\t0, 1, 0,\r\n\t\t\t1, -4, 1,\r\n\t\t\t0, 1, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.sobelX = function () {\r\n\t\t_filter.convolution.call(this, [\r\n\t\t\t-1, 0, 1,\r\n\t\t\t-2, 0, 2,\r\n\t\t\t-1, 0, 1\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.sobelY = function () {\r\n\t\t_filter.convolution.call(this, [\r\n\t\t\t-1, -2, -1,\r\n\t\t\t0, 0, 0,\r\n\t\t\t1, 2, 1\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.sharpen = function (amount) {\r\n\t\tvar a = amount || 1;\r\n\t\t_filter.convolution.call(this, [\r\n\t\t\t0, -1 * a, 0,\r\n\t\t\t-1 * a, 1 + 4 * a, -1 * a,\r\n\t\t\t0, -1 * a, 0\r\n\t\t]);\r\n\t};\r\n\r\n\t_filter.emboss = function (size) {\r\n\t\tvar s = size || 1;\r\n\t\t_filter.convolution.call(this, [\r\n\t\t\t-2 * s, -1 * s, 0,\r\n\t\t\t-1 * s, 1, 1 * s,\r\n\t\t\t0, 1 * s, 2 * s\r\n\t\t]);\r\n\t};\r\n\r\n\r\n\t// -------------------------------------------------------------------------\r\n\t// Blur Filter\r\n\r\n\t_filter.blur = function (size) {\r\n\t\tvar blurSizeX = (size / 7) / _width;\r\n\t\tvar blurSizeY = (size / 7) / _height;\r\n\r\n\t\tvar program = _compileShader(_filter.blur.SHADER);\r\n\r\n\t\t// Vertical\r\n\t\tgl.uniform2f(program.uniform.px, 0, blurSizeY);\r\n\t\t_draw(DRAW.INTERMEDIATE);\r\n\r\n\t\t// Horizontal\r\n\t\tgl.uniform2f(program.uniform.px, blurSizeX, 0);\r\n\t\t_draw();\r\n\t};\r\n\r\n\t_filter.blur.SHADER = [\r\n\t\t'precision highp float;',\r\n\t\t'varying vec2 vUv;',\r\n\t\t'uniform sampler2D texture;',\r\n\t\t'uniform vec2 px;',\r\n\r\n\t\t'void main(void) {',\r\n\t\t'gl_FragColor = vec4(0.0);',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv                             )*0.159576912161;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;',\r\n\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;',\r\n\t\t'}',\r\n\t].join('\\n');\r\n\r\n\r\n\t// -------------------------------------------------------------------------\r\n\t// Pixelate Filter\r\n\r\n\t_filter.pixelate = function (size) {\r\n\t\tvar blurSizeX = (size) / _width;\r\n\t\tvar blurSizeY = (size) / _height;\r\n\r\n\t\tvar program = _compileShader(_filter.pixelate.SHADER);\r\n\r\n\t\t// Horizontal\r\n\t\tgl.uniform2f(program.uniform.size, blurSizeX, blurSizeY);\r\n\t\t_draw();\r\n\t};\r\n\r\n\t_filter.pixelate.SHADER = [\r\n\t\t'precision highp float;',\r\n\t\t'varying vec2 vUv;',\r\n\t\t'uniform vec2 size;',\r\n\t\t'uniform sampler2D texture;',\r\n\r\n\t\t'vec2 pixelate(vec2 coord, vec2 size) {',\r\n\t\t'return floor( coord / size ) * size;',\r\n\t\t'}',\r\n\r\n\t\t'void main(void) {',\r\n\t\t'gl_FragColor = vec4(0.0);',\r\n\t\t'vec2 coord = pixelate(vUv, size);',\r\n\t\t'gl_FragColor += texture2D(texture, coord);',\r\n\t\t'}',\r\n\t].join('\\n');\r\n};\r\n\r\nexport {\r\n\tWebGLImageFilter\r\n}\r\n// })(window);\r\n","<template>\r\n  <div id=\"app\">\r\n    <img\r\n      id=\"shareBg\"\r\n      src=\"/picture/share-bg2.png\"\r\n      style=\"visibility: hidden; width: 1080px; height: 1920px\"\r\n    />\r\n    <canvas id=\"drawFrame\" style=\"display: none\" />\r\n    <canvas\r\n      id=\"sharePoster\"\r\n      width=\"1080\"\r\n      height=\"1920\"\r\n      style=\"display: none; position: fixed; left: 0; top: 0\"\r\n    />\r\n    <div id=\"inputTextSvg\" width=\"80%\" height=\"200px\"></div>\r\n    <div\r\n      :class=\"pageIndex == 0 || pageIndex == 5 ? 'bg' + pageIndex : 'bg1234'\"\r\n    ></div>\r\n    <canvas\r\n      :class=\"\r\n        pageIndex == 0 || pageIndex == 5 ? 'show' + pageIndex : 'show1234'\r\n      \"\r\n      id=\"canvas\"\r\n      width=\"1080px\"\r\n      height=\"1920px\"\r\n    />\r\n    <img id=\"canvasCopy\" src=\"\" />\r\n\r\n    <video\r\n      :class=\"\r\n        pageIndex == 0 || pageIndex == 5 ? 'screen' + pageIndex : 'screen1234'\r\n      \"\r\n      preload=\"auto\"\r\n      src=\"/video/screen.mp4\"\r\n      autoplay\r\n      loop\r\n      muted\r\n    />\r\n    <video\r\n      id=\"videoel\"\r\n      :class=\"\r\n        pageIndex == 0 || pageIndex == 5 ? 'video' + pageIndex : 'video1234'\r\n      \"\r\n      preload=\"auto\"\r\n      autoPlay\r\n    ></video>\r\n    <img\r\n      class=\"title\"\r\n      :src=\"'/picture/title' + pageIndex + '@x3.png'\"\r\n      alt=\"magic draw\"\r\n    />\r\n    <div\r\n      id=\"paint\"\r\n      v-show=\"pageIndex >= 4\"\r\n      :style=\"\r\n        pageIndex == 5\r\n          ? 'transform: scale(0.8); transform-origin: 50% 35%;'\r\n          : ''\r\n      \"\r\n    ></div>\r\n    <img\r\n      class=\"decor-bottom\"\r\n      src=\"/picture/decor-bottom.png\"\r\n      v-show=\"pageIndex == 0\"\r\n    />\r\n    <img\r\n      :class=\"\r\n        pageIndex == 0 || pageIndex == 5 ? 'machine' + pageIndex : 'machine1234'\r\n      \"\r\n      src=\"/picture/machine@x3.png\"\r\n      alt=\"machine\"\r\n    />\r\n    <img\r\n      class=\"decor-top\"\r\n      src=\"/picture/decor-top.png\"\r\n      v-show=\"pageIndex == 0\"\r\n    />\r\n    <img\r\n      class=\"count\"\r\n      v-if=\"count <= 3 && count >= 1\"\r\n      :src=\"'/picture/count' + count + '@x3.png'\"\r\n    />\r\n    <div id=\"overlay\"></div>\r\n    <!-- 文字输入 start -->\r\n    <div class=\"input-container\" v-show=\"mode == 'text' && pageIndex == 3\">\r\n      <input\r\n        id=\"input\"\r\n        :value=\"input\"\r\n        class=\"input\"\r\n        @input=\"onInputChange\"\r\n        @focus=\"isInputting = true\"\r\n        @blur=\"isInputting = false\"\r\n        placeholder=\"点击输入名字\"\r\n        autocomplete=\"off\"\r\n      />\r\n      <img\r\n        src=\"/picture/finishbtn.png\"\r\n        class=\"finish-btn\"\r\n        v-show=\"isInputting\"\r\n      />\r\n    </div>\r\n    <!-- 文字输入 end -->\r\n\r\n    <!-- 图形输入 start -->\r\n    <div class=\"shape-container\" v-show=\"mode == 'shape' && pageIndex == 3\">\r\n      <div class=\"text\">请选择：</div>\r\n      <div class=\"shapes\">\r\n        <img\r\n          v-for=\"item in shapeList\"\r\n          :key=\"item\"\r\n          :src=\"'/picture/' + item + '.png'\"\r\n          :class=\"item == shape ? 'checked-shape' : 'shape'\"\r\n          @click=\"setShape\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <!-- 图形输入 end -->\r\n    <img\r\n      :class=\"\r\n        pageIndex == 0 || pageIndex == 5\r\n          ? 'bottom-info' + pageIndex\r\n          : 'bottom-info1234'\r\n      \"\r\n      :src=\"'/picture/infobottom' + pageIndex + '@x3.png'\"\r\n      alt=\"info bottom\"\r\n    />\r\n    <canvas v-show=\"pageIndex == 5\" id=\"shareQrcode\"></canvas>\r\n    <img v-show=\"pageIndex == 5\" id=\"qrcode\" src=\"/picture/qrcode.jpg\" />\r\n\r\n    <div v-show=\"pageIndex == 5\" class=\"timestamp\">{{ timestamp }}</div>\r\n    <img\r\n      :class=\"\r\n        pageIndex == 0 || pageIndex == 5 ? 'btn0' + pageIndex : 'btn01234'\r\n      \"\r\n      @click=\"firstPageAni\"\r\n      src=\"/picture/btn00@x3.png\"\r\n      alt=\"button\"\r\n      v-show=\"pageIndex != 3\"\r\n    />\r\n    <img\r\n      :class=\"\r\n        pageIndex == 0 || pageIndex == 5\r\n          ? 'back-btn' + pageIndex\r\n          : 'back-btn1234'\r\n      \"\r\n      @click=\"back\"\r\n      src=\"/picture/back-normal@x3.png\"\r\n      alt=\"button\"\r\n    />\r\n    <img\r\n      class=\"btn0\"\r\n      @click=\"next\"\r\n      src=\"/picture/btn0@x3.png\"\r\n      v-show=\"pageIndex == 0\"\r\n      alt=\"button\"\r\n    />\r\n    <img\r\n      class=\"btn1234\"\r\n      @click=\"next\"\r\n      src=\"/picture/btn1@x3.png\"\r\n      v-show=\"isBtn1Show\"\r\n      alt=\"button\"\r\n    />\r\n    <img\r\n      class=\"btn1234\"\r\n      @click=\"next\"\r\n      src=\"/picture/btn2@x3.png\"\r\n      v-show=\"pageIndex == 2\"\r\n      alt=\"button\"\r\n    />\r\n    <img\r\n      class=\"btn1234\"\r\n      @click=\"next\"\r\n      src=\"/picture/btn3@x3.png\"\r\n      v-show=\"pageIndex == 3\"\r\n      alt=\"button\"\r\n    />\r\n    <img\r\n      class=\"btn1234\"\r\n      @click=\"next\"\r\n      src=\"/picture/btn4@x3.png\"\r\n      v-show=\"pageIndex == 4\"\r\n      alt=\"button\"\r\n    />\r\n    <img\r\n      class=\"btn5\"\r\n      @click=\"next\"\r\n      src=\"/picture/btn5@x3.png\"\r\n      v-show=\"pageIndex == 5\"\r\n      alt=\"button\"\r\n    />\r\n    <img\r\n      class=\"loading\"\r\n      src=\"/picture/loading.gif\"\r\n      v-show=\"isLoading && pageIndex == 4\"\r\n    />\r\n    <div v-show=\"false\">\r\n      <audio id=\"button-audio\" src=\"/audio/button.mp3\" preload />\r\n      <audio id=\"count-audio\" src=\"/audio/count.mp3\" preload />\r\n      <audio id=\"keyboard-audio\" src=\"/audio/keyboard.mp3\" preload />\r\n      <audio id=\"shoot-audio\" src=\"/audio/shoot.mp3\" preload />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SimpleKeyboard from \"./components/SimpleKeyboard.vue\";\r\nimport QRCode from \"qrcode\";\r\nimport { SVG } from \"@svgdotjs/svg.js\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport { WebGLImageFilter } from \"./lib/webgl-image-filter\";\r\n// import tracking from \"./lib/tracking.js\";\r\n// import tracking from \"./lib/tracking-min.js\";\r\n// import \"./lib/face-min.js\";\r\n// import {GIF,URL} from \"./lib/gif.js\";\r\nimport axios from \"axios\";\r\nconst CancelToken = axios.CancelToken;\r\n\r\nexport default {\r\n  name: \"App\",\r\n  components: {\r\n    SimpleKeyboard,\r\n  },\r\n  /**\r\n   * @typedef {object} Data\r\n   * @property {('text'|'shape')} Data.mode\r\n   * @property {?XMLDocument} Data.mlDoc\r\n   * @property {import('@svgdotjs/svg.js').Svg} Data.textSvgObj\r\n   * @property {import('@svgdotjs/svg.js').Text} Data.textObj\r\n   * @property {string} Data.input - 用户输入文本，显示在输入框中\r\n   * @property {string} Data.drawingInput - 用于绘制图片的文本\r\n   * @property {string} Data.defaultInput - 在drawingInput为空时使用defaultInput作为文本来绘制图片\r\n   * @property {string} Data.timestamp\r\n   * @returns {Data}\r\n   */\r\n  data() {\r\n    return {\r\n      mode: \"text\", // ['text',shape]\r\n      isVideoNeeded: false,\r\n      pageIndex: 0,\r\n      isInputting: false,\r\n      // 包含text的svg对象\r\n      textSvgObj: null,\r\n      // text元素对象\r\n      textObj: null,\r\n      textWidth: 0,\r\n      textHeight: 0,\r\n      // input的值\r\n      input: \"\",\r\n      drawingInput: \"\",\r\n      defaultInput: \"LENOVO\",\r\n      count: 4,\r\n      videoObj: null,\r\n      maxHeight: 500,\r\n      xmlDoc: null,\r\n      cancelAjax: null,\r\n      screenshots: [],\r\n      isLoading: false,\r\n      timestamp: \"\",\r\n      shape: \"rect\",\r\n      shapeList: [\"circle\", \"rect\", \"tri\"],\r\n      isBtn1Show: false,\r\n    };\r\n  },\r\n  methods: {\r\n    // 第0页切换到第1页的动画\r\n    firstPageAni(e) {\r\n      let btn = e.target;\r\n      // 先让btn00切换为第1页的按钮图片\r\n      setTimeout(() => {\r\n        btn.src = \"/picture/btn01@x3.png\";\r\n      }, 50);\r\n\r\n      // btn01把btn00盖上后再把图片换回来\r\n      setTimeout(() => {\r\n        btn.src = \"/picture/btn00@x3.png\";\r\n        this.next(e);\r\n      }, 200);\r\n    },\r\n    // 下一页\r\n    next(e) {\r\n      // 绘制中不能进入下一页，绘制完成后自动跳转到下一页\r\n      if (this.pageIndex == 4) {\r\n        return;\r\n      }\r\n      // 播放音效\r\n      document.getElementById(\"button-audio\").play();\r\n\r\n      this.pageIndex += 1;\r\n\r\n      // 循环回第0页\r\n      if (this.pageIndex >= 6) {\r\n        this.pageIndex -= 6;\r\n      }\r\n      // 进入页面之后的处理逻辑\r\n      switch (this.pageIndex) {\r\n        case 0: {\r\n          document.getElementById(\"paint\").innerHTML = \"\";\r\n          document.getElementById(\"videoel\").style.opacity = 0;\r\n          this.$nextTick(function () {\r\n            document.getElementsByClassName(\"show0\")[0].style.opacity = 0;\r\n            document.getElementsByClassName(\"btn00\")[0].style.opacity = 1;\r\n            document.getElementsByClassName(\"back-btn0\")[0].style.display =\r\n              \"none\";\r\n          });\r\n          this.input = \"\";\r\n          break;\r\n        }\r\n        case 1: {\r\n          document.getElementById(\"videoel\").play();\r\n          document.getElementById(\"videoel\").style.opacity = 1;\r\n          setTimeout(() => {\r\n            this.isBtn1Show = true;\r\n            document.getElementsByClassName(\"back-btn1234\")[0].style.display =\r\n              \"block\";\r\n            document.getElementsByClassName(\"btn01234\")[0].style.opacity = 0;\r\n          }, 600);\r\n          break;\r\n        }\r\n        case 2: {\r\n          let btn = e.target;\r\n          setTimeout(() => {\r\n            btn.src = \"/picture/btn1-pressed@x3.png\";\r\n          }, 50);\r\n\r\n          setTimeout(() => {\r\n            btn.src = \"/picture/btn2@x3.png\";\r\n            this.isBtn1Show = false;\r\n          }, 200);\r\n\r\n          this.takePhoto();\r\n          break;\r\n        }\r\n        case 3: {\r\n          // 显示键盘，输入文字\r\n          // 通过提前设置好的注册表项唤醒系统键盘\r\n          // location.replace(\"tabkey:\");\r\n          // this.$nextTick(() => {\r\n          //   document.getElementById(\"input\").focus();\r\n          // });\r\n\r\n          break;\r\n        }\r\n        case 4: {\r\n          // 模式为shape时，需要选择图形之后才能获取svg编码\r\n          if (this.mode == \"shape\") {\r\n            // 获取摄像头捕捉到的图像的base64\r\n            let base64 = this.drawPhoto();\r\n\r\n            // 调用接口获取svg编码\r\n            this.getSvg(base64);\r\n          }\r\n\r\n          // 按钮按下动效\r\n          let btn = e.target;\r\n          setTimeout(() => {\r\n            btn.src = \"/picture/btn3-pressed@x3.png\";\r\n          }, 50);\r\n          setTimeout(() => {\r\n            btn.src = \"/picture/btn4@x3.png\";\r\n          }, 200);\r\n\r\n          // 检查接口是否已返回值，未返回则显示加载动图\r\n          if (this.xmlDoc == null) {\r\n            this.isLoading = true;\r\n          }\r\n\r\n          // 绘制svg\r\n          this.drawSvg();\r\n\r\n          break;\r\n        }\r\n        case 5: {\r\n          // 绘制二维码并显示\r\n          // this.makeCode();\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    // 上一页\r\n    back(e) {\r\n      let btn = e.target;\r\n      // 按钮按下动效以及音效\r\n      setTimeout(() => {\r\n        btn.src = \"/picture/back-pressed@x3.png\";\r\n      }, 50);\r\n      setTimeout(() => {\r\n        btn.src = \"/picture/back-normal@x3.png\";\r\n      }, 200);\r\n      document.getElementById(\"button-audio\").play();\r\n\r\n      // 拍照中和绘制中不允许返回\r\n      if (this.pageIndex == 2 || this.pageIndex == 4) {\r\n        return;\r\n      }\r\n      this.pageIndex -= 1;\r\n      if (this.pageIndex == 2) {\r\n        this.pageIndex -= 1;\r\n      }\r\n      // 进入页面之后的处理逻辑\r\n      switch (this.pageIndex) {\r\n        case 0: {\r\n          document.getElementById(\"paint\").innerHTML = \"\";\r\n          document.getElementById(\"videoel\").style.opacity = 0;\r\n          this.isBtn1Show = false;\r\n          document.getElementsByClassName(\"back-btn1234\")[0].style.display =\r\n            \"none\";\r\n          document.getElementsByClassName(\"btn01234\")[0].style.opacity = 1;\r\n          this.$nextTick(function () {\r\n            document.getElementsByClassName(\"show0\")[0].style.opacity = 0;\r\n            document.getElementsByClassName(\"btn00\")[0].style.opacity = 1;\r\n          });\r\n          this.input = \"\";\r\n          break;\r\n        }\r\n        case 1: {\r\n          this.input = \"\";\r\n          this.isBtn1Show = true;\r\n          document.getElementById(\"videoel\").play();\r\n          document.getElementById(\"videoel\").style.opacity = 1;\r\n          // 从第2页返回则取消获取svg编码的请求\r\n          // if (typeof this.cancelAjax === `function`) {\r\n          //   this.cancelAjax();\r\n          //   this.cancelAjax = null;\r\n          // }\r\n          if (this.xmlDoc != null) {\r\n            this.xmlDoc = null;\r\n          }\r\n          break;\r\n        }\r\n        case 2: {\r\n          break;\r\n        }\r\n        case 3: {\r\n          // 显示键盘，输入文字\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    // 拍照\r\n    takePhoto() {\r\n      // 显示倒计时\r\n      this.count = 3;\r\n      document.getElementById(\"count-audio\").play();\r\n      // 更新倒计时\r\n      let intervalId = setInterval(() => {\r\n        document.getElementById(\"count-audio\").play();\r\n        this.count -= 1;\r\n        if (this.count <= 0) {\r\n          // 闪光灯动效\r\n          let overlay = document.getElementById(\"overlay\");\r\n          overlay.style.display = \"block\";\r\n          document.getElementById(\"shoot-audio\").play();\r\n          setTimeout(() => {\r\n            overlay.style.display = \"none\";\r\n          }, 500);\r\n\r\n          // 停止倒计时\r\n          clearInterval(intervalId);\r\n          this.count = 4;\r\n\r\n          // 停止播放视频流并获取当前画面的base64\r\n          this.videoObj.pause();\r\n\r\n          // 模式为text时，拍照之后即可获取svg，减少等待时间\r\n          if (this.mode == \"text\") {\r\n            // 获取摄像头捕捉到的图像的base64\r\n            let base64 = this.drawPhoto();\r\n            // 调用接口获取svg编码\r\n            this.getSvg(base64);\r\n          }\r\n          this.next();\r\n        }\r\n      }, 1000);\r\n    },\r\n\r\n    /**\r\n     * @typedef {(SVGRectElement|SVGPolygonElement|SVGGElement)} DrawableSvgElement - SVG {Rect|Polygen|G} Element\r\n     * @callback AddShapeCallback 用于绘制指定 DrawableSvgElement 元素的回调函数\r\n     * @param {import('@svgdotjs/svg.js').Svg} draw - SVG元素的封装，用于绘制 SVG 元素\r\n     * @param {HTMLCollectionOf<DrawableSvgElement>} collection - 待绘制的所有元素的集合\r\n     * @param {number} i - 当前被绘制元素的下标\r\n     *\r\n     * @typedef {object} CollectionAndCallback - 一个包含待绘制的 DrawableSvgElement 的集合以及对应的 addShapeCallback 的对象\r\n     * @property {Array<DrawableSvgElement>} collection\r\n     * @property {AddShapeCallback} addShape\r\n     */\r\n\r\n    /**\r\n     * 根据绘制类型返回指定的 SVG 元素集合以及绘制该类型元素的回调函数\r\n     * @param {string} type - 一个表示绘制类型的字符串\r\n     * @returns {CollectionAndCallback}\r\n     */\r\n    getCollectionAndCallback(type) {\r\n      const mapping = {\r\n        textRect: {\r\n          collection: this.xmlDoc.getElementsByTagName(\"rect\"),\r\n          addShape: this.addTextRect,\r\n        },\r\n        rect: {\r\n          collection: this.xmlDoc.getElementsByTagName(\"polygon\"),\r\n          addShape: this.addRotatedRect,\r\n        },\r\n        circle: {\r\n          collection: this.xmlDoc.getElementsByTagName(\"g\"),\r\n          addShape: this.addRotatedEllipse,\r\n        },\r\n        tri: {\r\n          collection: this.xmlDoc.getElementsByTagName(\"polygon\"),\r\n          addShape: this.addTri,\r\n        },\r\n      };\r\n\r\n      return mapping[type];\r\n    },\r\n    // 绘制svg\r\n    drawSvg() {\r\n      // 每画一次的时间间隔。单位：毫秒\r\n      let ms = 18;\r\n      // 如果数据还没获取到，每0.5s尝试一次\r\n      if (this.xmlDoc == null) {\r\n        setTimeout(() => {\r\n          this.drawSvg();\r\n        }, 500);\r\n        return;\r\n      }\r\n      this.isLoading = false;\r\n      console.log(this.xmlDoc);\r\n      const { collection, addShape } = this.getCollectionAndCallback(\r\n        this.shape\r\n      );\r\n\r\n      /** @type {import('@svgdotjs/svg.js').Svg} */\r\n      const draw = SVG().addTo(\"#paint\").size(\"100%\", \"100%\");\r\n      draw.attr(\"id\", \"draw\");\r\n      document.getElementById(\"videoel\").style.opacity = 0;\r\n      collection.forEach((el, i) => {\r\n        setTimeout(() => {\r\n          // 每绘制8次取一帧，这些帧会传回后端生成视频\r\n          if (i % 8 == 0) {\r\n            this.addFrame(i / 8, i / collection.length);\r\n          }\r\n          // 背景透明度逐渐增加\r\n          document.querySelector(\".show1234\").style.opacity =\r\n            i / collection.length;\r\n          // 在svg中加入一个图形\r\n          addShape(draw, collection, i);\r\n        }, ms * i);\r\n      });\r\n\r\n      // 绘制结束后，把获取到的帧穿回后端生成视频\r\n      setTimeout(() => {\r\n        // 按时间生成编号\r\n        let now = new Date();\r\n        let addZero = (str) => (str.length == 2 ? str : \"0\" + str);\r\n\r\n        this.timestamp =\r\n          addZero(now.getHours().toString()) +\r\n          addZero(now.getMinutes().toString()) +\r\n          addZero(now.getSeconds().toString());\r\n        // 是否需要生成视频\r\n        if (this.isVideoNeeded) {\r\n          // 调用接口传回帧\r\n          this.postImages();\r\n        }\r\n        // 绘制二维码\r\n        this.makeCode();\r\n        // 调用接口传回海报\r\n        this.postPoster();\r\n        this.pageIndex += 1;\r\n        this.$nextTick(() => {\r\n          document.getElementsByClassName(\"back-btn5\")[0].style.display =\r\n            \"none\";\r\n        });\r\n      }, ms * collection.length);\r\n      this.xmlDoc = null;\r\n    },\r\n    // 保存绘制的帧\r\n    addFrame(i, alpha) {\r\n      // var svg = document.getElementById(\"draw\").innerHTML;\r\n      var svg = document.getElementById(\"draw\").outerHTML;\r\n      var canvas = document.getElementById(\"drawFrame\");\r\n      var c = canvas.getContext(\"2d\");\r\n      // var img = new Image()\r\n      var img = document.createElement(\"img\");\r\n      img.width = 862;\r\n      img.height = 1150;\r\n      // document.body.append(img);\r\n      //svg内容\r\n      // img.src = \"data:image/svg+xml,\" + unescape(encodeURIComponent(svg)); //svg内容中可以有中文字符\r\n\r\n      // console.log([document.getElementById(\"draw\")]);\r\n      // console.log(SVG(\"#draw\"));\r\n      // console.log(SVG(\"#draw\").svg());\r\n      // console.log(document.getElementById(\"draw\").innerHTML);\r\n      // console.log(img.src);\r\n      img.onload = () => {\r\n        //将canvas的宽高设置为图像的宽高\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n        c.clearRect(0, 0, canvas.width, canvas.height);\r\n        // c.translate(862, 0);\r\n        // c.scale(-1, 1); //左右镜像翻转\r\n        // console.log(img.width, img.height);\r\n        //canvas画图片\r\n        if (i != 0) {\r\n          // console.log(document.getElementById(\"canvas\"))\r\n          c.globalAlpha = alpha;\r\n          c.drawImage(\r\n            document.getElementById(\"canvasCopy\"),\r\n            0,\r\n            0,\r\n            canvas.width,\r\n            canvas.height\r\n          );\r\n          c.globalAlpha = 1;\r\n        }\r\n        // c.scale(-1,1);\r\n        // c.drawImage()\r\n        c.drawImage(img, 0, 0);\r\n\r\n        this.screenshots[i] = canvas.toDataURL(\"image/png\");\r\n        // console.log(this.screenshots);\r\n      };\r\n      img.onerror = () => {\r\n        //将canvas的宽高设置为图像的宽高\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n        c.clearRect(0, 0, canvas.width, canvas.height);\r\n        c.translate(862, 0);\r\n        c.scale(-1, 1); //左右镜像翻转\r\n        // console.log(img.width, img.height);\r\n        //canvas画图片\r\n        if (i != 0) {\r\n          // console.log(document.getElementById(\"canvas\"))\r\n          c.globalAlpha = alpha;\r\n          c.drawImage(\r\n            document.getElementById(\"canvasCopy\"),\r\n            0,\r\n            0,\r\n            canvas.width,\r\n            canvas.height\r\n          );\r\n          c.globalAlpha = 1;\r\n        }\r\n        // c.scale(-1,1);\r\n        // c.drawImage()\r\n        c.drawImage(img, 0, 0);\r\n\r\n        this.screenshots[i] = canvas.toDataURL(\"image/png\");\r\n        // console.log(this.screenshots);\r\n      };\r\n      //svg内容\r\n      // img.src = \"data:image/svg+xml,\" + unescape(encodeURIComponent(svg)); //svg内容中可以有中文字符\r\n      // img.src = 'data:image/svg+xml,' + svg;//svg内容中不能有中文字符\r\n\r\n      // //svg编码成base64\r\n      img.src =\r\n        \"data:image/svg+xml;base64,\" + btoa(unescape(encodeURIComponent(svg))); //svg内容中可以有中文字符\r\n      // console.log(img.src)\r\n      // img.src = 'data:image/svg+xml;base64,' + window.btoa(svg);//svg内容中不能有中文字符\r\n    },\r\n    // 调用接口传回帧\r\n    postImages() {\r\n      // 传送截图给后端\r\n      var images = this.screenshots;\r\n      var settings = {\r\n        url: \"http://localhost:3000/make-video\",\r\n        method: \"POST\",\r\n        timeout: 0,\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        data: JSON.stringify({ data: images, timestamp: this.timestamp }),\r\n      };\r\n      axios(settings).then((res) => {\r\n        console.log(res);\r\n        this.screenshots = [];\r\n      });\r\n    },\r\n    // 调用接口传回海报\r\n    postPoster() {\r\n      // 生成海报\r\n      let sharePoster = document.getElementById(\"sharePoster\");\r\n      const ctx = sharePoster.getContext(\"2d\");\r\n      let shareBg = document.getElementById(\"shareBg\");\r\n      let lastFrame = document.getElementById(\"drawFrame\");\r\n      // 根据需求，有时shareBg自带二维码，有时需要自己绘制\r\n      let qrcode = document.getElementById(\"shareQrcode\");\r\n      ctx.drawImage(shareBg, 0, 0, 1080, 1920, 0, 0, 1080, 1920);\r\n      ctx.drawImage(lastFrame, 0, 0, 862, 1150, 0, 45, 1080, 1440);\r\n      // ctx.drawImage(qrcode, 0, 0, 148, 148, 840, 1570, 200, 200);\r\n      var settings = {\r\n        url: \"http://localhost:3000/poster\",\r\n        method: \"POST\",\r\n        timeout: 0,\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        data: JSON.stringify({\r\n          data: sharePoster.toDataURL(\"image/png\"),\r\n          timestamp: this.timestamp,\r\n        }),\r\n      };\r\n      axios(settings).then((res) => {\r\n        console.log(res);\r\n      });\r\n    },\r\n    mulRatio(str, ratio) {\r\n      let translateX = 0;\r\n      let translateY = 0;\r\n      let rotate = 0;\r\n      let scaleX = 0;\r\n      let scaleY = 0;\r\n      let i = 10;\r\n      while (str[i] != \" \") {\r\n        translateX += str[i];\r\n        i++;\r\n      }\r\n      i++;\r\n      while (str[i] != \")\") {\r\n        translateY += str[i];\r\n        i++;\r\n      }\r\n      i += 9;\r\n      while (str[i] != \")\") {\r\n        rotate += str[i];\r\n        i++;\r\n      }\r\n      i += 8;\r\n      while (str[i] != \" \") {\r\n        scaleX += str[i];\r\n        i++;\r\n      }\r\n      i++;\r\n      while (str[i] != \")\") {\r\n        scaleY += str[i];\r\n        i++;\r\n      }\r\n\r\n      translateX = parseInt(translateX) * ratio;\r\n      translateY = parseInt(translateY) * ratio;\r\n      // rotate = parseInt(rotate) * ratio\r\n      scaleX = parseInt(scaleX) * ratio;\r\n      scaleY = parseInt(scaleY) * ratio;\r\n      return (\r\n        \"translate(\" +\r\n        translateX +\r\n        \" \" +\r\n        translateY +\r\n        \") rotate(\" +\r\n        rotate +\r\n        \") scale(\" +\r\n        scaleX +\r\n        \" \" +\r\n        scaleY +\r\n        \")\"\r\n      );\r\n    },\r\n    // 添加文字\r\n    /**\r\n     * @param {import('@svgdotjs/svg.js').Svg} draw - SVG元素的封装，用于绘制 SVG 元素\r\n     * @param {HTMLCollectionOf<DrawableSvgElement>} collection - 待绘制的所有元素的集合\r\n     * @param {number} i - 当前被绘制元素的下标\r\n     *\r\n     * @returns {CollectionAndCallback}\r\n     */\r\n    addTextRect(draw, collection, i) {\r\n      // console.log(i)\r\n      let x = parseFloat(collection[i].attributes.x.value);\r\n      let y = parseFloat(collection[i].attributes.y.value);\r\n      let width = parseFloat(collection[i].attributes.width.value);\r\n      let height = parseFloat(collection[i].attributes.height.value);\r\n      let fill = collection[i].attributes.fill.value;\r\n      // eslint-disable-next-line no-unused-vars\r\n      let fill_opacity = collection[i].attributes[\"fill-opacity\"].value;\r\n      // eslint-disable-next-line no-unused-vars\r\n      let length = collection.length;\r\n\r\n      let ratio1_h = width / this.textWidth;\r\n      let ratio2_h = height / this.textHeight;\r\n\r\n      let ratio1_v = width / this.textHeight;\r\n      let ratio2_v = height / this.textWidth;\r\n\r\n      let ratio = 1150 / this.maxHeight;\r\n      x *= ratio;\r\n      y *= ratio;\r\n      width *= ratio;\r\n      height *= ratio;\r\n      ratio1_h *= ratio;\r\n      ratio1_v *= ratio;\r\n      ratio2_h *= ratio;\r\n      ratio2_v *= ratio;\r\n\r\n      let rect = draw.rect({\r\n        width: width,\r\n        height: height,\r\n        x: x,\r\n        y: y,\r\n      });\r\n      rect.attr(\"id\", \"rect\" + i);\r\n      rect.attr(\"fill-rule\", \"nonzero\");\r\n\r\n      let group = draw.group();\r\n      group.attr(\"id\", \"rect\" + i);\r\n      group.attr(\"fill-rule\", \"nonzero\");\r\n\r\n      rect.attr(\"fill\", fill);\r\n      rect.attr(\"fill-opacity\", 0.1);\r\n\r\n      group.attr(\"fill\", fill);\r\n      group.attr(\"fill-opacity\", 0.4 + i / length / 5);\r\n\r\n      let text = this.textObj.text();\r\n      group.plain(text);\r\n      group.attr(\"font-size\", \"100px\");\r\n      group.attr(\"font-weight\", \"bold\");\r\n      group.attr(\"font-family\", \"fantasy\");\r\n      if (width > height) {\r\n        // 水平\r\n        group.attr(\r\n          \"transform\",\r\n          \"translate(\" +\r\n            x +\r\n            \",\" +\r\n            (y + height * 0.82) +\r\n            \") scale(\" +\r\n            ratio1_h +\r\n            \",\" +\r\n            ratio2_h +\r\n            \")\"\r\n        );\r\n      } else {\r\n        // 垂直\r\n        group.attr(\r\n          \"transform\",\r\n          \"translate(\" +\r\n            x +\r\n            \",\" +\r\n            y +\r\n            \") scale(\" +\r\n            ratio1_v +\r\n            \",\" +\r\n            ratio2_v +\r\n            \") rotate(90)\"\r\n        );\r\n      }\r\n    },\r\n    // 添加矩形\r\n    addRect(draw, collection, i) {\r\n      // console.log(i)\r\n      let x = parseFloat(collection[i].attributes.x.value);\r\n      let y = parseFloat(collection[i].attributes.y.value);\r\n      let width = parseFloat(collection[i].attributes.width.value);\r\n      let height = parseFloat(collection[i].attributes.height.value);\r\n      let fill = collection[i].attributes.fill.value;\r\n\r\n      let ratio = 1150 / this.maxHeight;\r\n      x *= ratio;\r\n      y *= ratio;\r\n      width *= ratio;\r\n      height *= ratio;\r\n\r\n      let rect = draw.rect({\r\n        width: width,\r\n        height: height,\r\n        x: x,\r\n        y: y,\r\n      });\r\n      rect.attr(\"id\", \"rect\" + i);\r\n      rect.attr(\"fill-rule\", \"nonzero\");\r\n\r\n      rect.attr(\"fill\", fill);\r\n      rect.attr(\"fill-opacity\", 0.5);\r\n    },\r\n    // 添加旋转矩形\r\n    addRotatedRect(draw, collection, i) {\r\n      let ratio = 1150 / this.maxHeight;\r\n      let pointsStr = \"\";\r\n      let points = collection[i].attributes.points.value.split(\" \");\r\n      for (let point in points) {\r\n        pointsStr += ratio * parseFloat(points[point]);\r\n        pointsStr += \" \";\r\n      }\r\n\r\n      let fill = collection[i].attributes.fill.value;\r\n\r\n      let polygon = draw.polygon(pointsStr);\r\n      polygon.attr(\"id\", \"rect\" + i);\r\n      polygon.attr(\"fill-rule\", \"nonzero\");\r\n\r\n      polygon.attr(\"fill\", fill);\r\n      polygon.attr(\"fill-opacity\", 0.5);\r\n    },\r\n    // 添加圆形\r\n    addCircle(draw, collection, i) {\r\n      // console.log(i)\r\n      let cx = parseFloat(collection[i].attributes.cx.value);\r\n      let cy = parseFloat(collection[i].attributes.cy.value);\r\n      let r = parseFloat(collection[i].attributes.r.value);\r\n      let fill = collection[i].attributes.fill.value;\r\n\r\n      let ratio = 1150 / this.maxHeight;\r\n      cx *= ratio;\r\n      cy *= ratio;\r\n      r *= ratio;\r\n\r\n      let circle = draw.circle({\r\n        cx: cx,\r\n        cy: cy,\r\n        r: r,\r\n      });\r\n      circle.attr(\"id\", \"circle\" + i);\r\n      circle.attr(\"fill-rule\", \"nonzero\");\r\n\r\n      circle.attr(\"fill\", fill);\r\n      circle.attr(\"fill-opacity\", 0.5);\r\n    },\r\n    // 添加旋转椭圆\r\n    addRotatedEllipse(draw, collection, i) {\r\n      // console.log(i)\r\n      let cx = 0;\r\n      let cy = 0;\r\n      let rx = 1;\r\n      let ry = 1;\r\n      let fill = collection[i].firstChild.attributes.fill.value;\r\n      let transform = collection[i].attributes.transform.value;\r\n\r\n      let ratio = 1150 / this.maxHeight;\r\n      // cx *= ratio;\r\n      // cy *= ratio;\r\n      // rx *= ratio;\r\n      // ry *= ratio;\r\n\r\n      transform = this.mulRatio(transform, ratio);\r\n\r\n      let g = draw.group();\r\n      g.attr(\"transform\", transform);\r\n      // console.log(g)\r\n      let re = g.ellipse({\r\n        cx: cx,\r\n        cy: cy,\r\n        rx: rx,\r\n        ry: ry,\r\n      });\r\n      re.attr(\"id\", \"r_ellipse\" + i);\r\n      re.attr(\"fill-rule\", \"nonzero\");\r\n\r\n      re.attr(\"fill\", fill);\r\n      re.attr(\"fill-opacity\", 0.5);\r\n    },\r\n    // 添加三角形\r\n    addTri(draw, collection, i) {\r\n      // console.log(i)\r\n      let ratio = 1150 / this.maxHeight;\r\n      let pointsStr = \"\";\r\n      let points = collection[i].attributes.points.value.split(\" \");\r\n      for (let point in points) {\r\n        let p = points[point].split(\",\");\r\n        pointsStr += ratio * parseFloat(p[0]);\r\n        pointsStr += \",\";\r\n        pointsStr += ratio * parseFloat(p[1]);\r\n        pointsStr += \" \";\r\n      }\r\n\r\n      let fill = collection[i].attributes.fill.value;\r\n\r\n      let polygon = draw.polygon(pointsStr);\r\n      polygon.attr(\"id\", \"rect\" + i);\r\n      polygon.attr(\"fill-rule\", \"nonzero\");\r\n\r\n      polygon.attr(\"fill\", fill);\r\n      polygon.attr(\"fill-opacity\", 0.5);\r\n    },\r\n    // 设置video元素视频源为本地相机\r\n    setVideoSrc() {\r\n      // 想要获取一个最接近 1280x720 的相机分辨率\r\n      var constraints = { audio: false, video: { width: 810, height: 1080 } };\r\n      // var constraints = { audio: false, video: { width: 360, height: 480 } };\r\n\r\n      navigator.mediaDevices\r\n        .getUserMedia(constraints)\r\n        .then((mediaStream) => {\r\n          this.videoObj.srcObject = mediaStream;\r\n          this.videoObj.onloadedmetadata = (e) => {\r\n            // console.log(e);\r\n            this.videoObj.play();\r\n          };\r\n        })\r\n        .catch(function (err) {\r\n          console.log(err.name + \": \" + err.message);\r\n        }); // 总是在最后检查错误\r\n    },\r\n    // 绘制video元素内容作为照片，绘制在canvas上，并返回base64\r\n    drawPhoto() {\r\n      let rect = this.videoObj.getBoundingClientRect();\r\n      let vid_width = rect.width;\r\n      let vid_height = rect.height;\r\n      // 压缩图片\r\n      // 最大尺寸限制\r\n      const maxWidth = this.maxHeight;\r\n      const maxHeight = this.maxHeight;\r\n      // 需要压缩的目标尺寸\r\n      let targetWidth = vid_width,\r\n        targetHeight = vid_height;\r\n      // console.log(targetWidth,targetHeight)\r\n      // 等比例计算超过最大限制时缩放后的图片尺寸\r\n      if (vid_width > maxWidth || vid_height > maxHeight) {\r\n        if (vid_width / vid_height > 1) {\r\n          // 宽图片\r\n          targetWidth = maxWidth;\r\n          targetHeight = Math.round(maxWidth * (vid_height / vid_width));\r\n        } else {\r\n          // 高图片\r\n          targetHeight = maxHeight;\r\n          targetWidth = Math.round(maxHeight * (vid_width / vid_height));\r\n        }\r\n      }\r\n      // 创建画布\r\n      const canvas = document.createElement(\"canvas\");\r\n      const context = canvas.getContext(\"2d\");\r\n\r\n      // 设置宽高度为等同于要压缩图片的尺寸\r\n      canvas.width = targetWidth;\r\n      canvas.height = targetHeight;\r\n      context.clearRect(0, 0, targetWidth, targetHeight);\r\n      context.translate(targetWidth, 0);\r\n      context.scale(-1, 1); //左右镜像翻转\r\n      //将img绘制到画布\r\n      context.drawImage(this.videoObj, 0, 0, targetWidth, targetHeight);\r\n\r\n      let filter = null;\r\n      let filteredCanvas = document.getElementById(\"canvas\");\r\n      try {\r\n        filter = new WebGLImageFilter({ canvas: filteredCanvas });\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n\r\n      // 调整图像参数\r\n      // filter.addFilter('hue', 180);\r\n      filter.addFilter(\"brightness\", 0.2);\r\n      filter.addFilter(\"contrast\", 0.3);\r\n      filter.addFilter(\"saturation\", -0.3);\r\n      filter.apply(canvas);\r\n\r\n      document.getElementById(\"canvasCopy\").src = filteredCanvas.toDataURL(\r\n        \"image/png\",\r\n        1\r\n      );\r\n      return filteredCanvas.toDataURL(\"image/png\", 1);\r\n    },\r\n    // 绘制二维码\r\n    makeCode() {\r\n      let qrcode = document.getElementById(\"shareQrcode\");\r\n      let url = \"http://xiaohui.ai/other-upload/\" + this.timestamp + \".mp4\";\r\n      QRCode.toCanvas(qrcode, url, function (error) {\r\n        if (error) console.error(error);\r\n      });\r\n    },\r\n    // 解析获取到的svg编码\r\n    xmlParse(text) {\r\n      let xmlDoc = null;\r\n      let parser = null;\r\n      try {\r\n        //Internet Explorer\r\n        // eslint-disable-next-line no-undef\r\n        xmlDoc = new ActiveXObject(\"Microsoft.XMLDOM\");\r\n        xmlDoc.async = \"false\";\r\n        xmlDoc.loadXML(text);\r\n      } catch (e) {\r\n        try {\r\n          //Firefox, Mozilla, Opera, etc.\r\n          parser = new DOMParser();\r\n          xmlDoc = parser.parseFromString(text, \"text/xml\");\r\n        } catch (e) {\r\n          alert(e.message);\r\n        }\r\n      }\r\n      // console.log(xmlDoc);\r\n      return xmlDoc;\r\n    },\r\n    // 调用接口获取svg编码\r\n    getSvg(base64) {\r\n      let _this = this;\r\n      var settings = {\r\n        url: \"http://localhost:3000/getsvg\",\r\n        method: \"POST\",\r\n        timeout: 0,\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        data: JSON.stringify({ data: base64, shape: _this.shape }),\r\n        cancelToken: new CancelToken(function executor(c) {\r\n          _this.cancelAjax = c;\r\n        }),\r\n      };\r\n      axios(settings).then((res) => {\r\n        console.log(res);\r\n        this.xmlDoc = this.xmlParse(res.data.data);\r\n        // this.isLoading = false;\r\n      });\r\n    },\r\n    /**\r\n     * 去除字符串中的emoji表情\r\n     *\r\n     * @param {string} str\r\n     * @returns {string}\r\n     */\r\n    removeEmoji(str) {\r\n      return str.replace(\r\n        /[\\uD83C|\\uD83D|\\uD83E][\\uDC00-\\uDFFF][\\u200D|\\uFE0F]|[\\uD83C|\\uD83D|\\uD83E][\\uDC00-\\uDFFF]|[0-9|*|#]\\uFE0F\\u20E3|[0-9|#]\\u20E3|[\\u203C-\\u3299]\\uFE0F\\u200D|[\\u203C-\\u3299]\\uFE0F|[\\u2122-\\u2B55]|\\u303D|[\\A9|\\AE]\\u3030|\\uA9|\\uAE|\\u3030/gi,\r\n        \"\"\r\n      );\r\n    },\r\n    /**\r\n     * 去除空格和emoji表情，如果输入为空则返回defaultInput\r\n     * @param {string} str - 用户输入\r\n     * @returns {string}\r\n     */\r\n    sanitizeInput(str) {\r\n      const sanitized = this.removeEmoji(str).trim();\r\n      return sanitized.length ? sanitized : this.defaultInput;\r\n    },\r\n    /**\r\n     * input更新时更新对应的data元素和svg\r\n     *\r\n     * @param {Event} input\r\n     */\r\n    onInputChange(input) {\r\n      // this.input = input.target.value.toUpperCase();\r\n      this.input = this.removeEmoji(input.target.value);\r\n\r\n      // 设置textSvg\r\n      if (this.textObj == null) {\r\n        this.textObj = this.textSvgObj.text(this.drawingInput);\r\n      } else {\r\n        this.textObj.clear();\r\n        this.textObj.text(this.drawingInput);\r\n      }\r\n\r\n      let rect = this.textObj.node.getBoundingClientRect();\r\n      this.textWidth = rect.width;\r\n      this.textHeight = rect.height;\r\n    },\r\n    // 设置图形\r\n    setShape(e) {\r\n      // console.log(e.target.src);\r\n      let arr = e.target.src.split(\"/\");\r\n      let src = arr[arr.length - 1].split(\".\")[0];\r\n      this.shape = src;\r\n    },\r\n  },\r\n  mounted: function () {\r\n    // 初始化\r\n    this.videoObj = document.getElementById(\"videoel\");\r\n    this.textSvgObj = SVG().addTo(\"#inputTextSvg\").size(\"100%\", \"100%\");\r\n    this.setVideoSrc();\r\n    if (this.mode == \"text\") {\r\n      this.shape = \"textRect\";\r\n    }\r\n  },\r\n  watch: {\r\n    /**\r\n     * 偷个懒，在 this.input 更新时同步更新 this.drawingInput\r\n     *\r\n     * @param {string} value\r\n     */\r\n    input(value) {\r\n      this.drawingInput = this.sanitizeInput(value);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\nbody {\r\n  overflow: hidden;\r\n}\r\n#app {\r\n  /* font-family: Avenir, Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale; */\r\n  text-align: center;\r\n  color: #2c3e50;\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  font-size: 100px;\r\n  font-weight: bold;\r\n  font-family: fantasy;\r\n  transition: all 1s;\r\n  background: transparent url(/picture/background.png) center center no-repeat;\r\n  /* margin-top: 60px; */\r\n  /* height: 100%;\r\n  width: 100%;\r\n  position: absolute; */\r\n}\r\n#canvasCopy {\r\n  display: none;\r\n}\r\n#inputTextSvg {\r\n  position: fixed;\r\n  bottom: 20%;\r\n  left: 13%;\r\n}\r\n#videoel {\r\n  /* transform: scale(1.065); */\r\n  /* transform-origin: 50% -250%; */\r\n  transform: rotateY(180deg);\r\n}\r\n.screen0 {\r\n  transition: all 1s;\r\n  width: 63%;\r\n  position: fixed;\r\n  left: 18.5%;\r\n  top: 17%;\r\n}\r\n.screen1234 {\r\n  transition: all 1s;\r\n  width: 78%;\r\n  position: fixed;\r\n  left: 11%;\r\n  top: 9%;\r\n  opacity: 0;\r\n}\r\n.screen5 {\r\n  transition: all 1s;\r\n  width: 63%;\r\n  position: fixed;\r\n  left: 18.5%;\r\n  top: 17%;\r\n  opacity: 0;\r\n}\r\n.video0 {\r\n  transition: all 1s;\r\n  transform: scale(0.9);\r\n  top: 15%;\r\n  left: 13%;\r\n  /* transform-origin: 50% -250%; */\r\n  opacity: 0;\r\n  position: fixed;\r\n}\r\n.video1234 {\r\n  transition: all 1s;\r\n  transform: scale(1.065);\r\n  position: fixed;\r\n  top: 11%;\r\n  left: 12%;\r\n  opacity: 1;\r\n}\r\n.video5 {\r\n  transition: all 1s;\r\n  transform: scale(0.9);\r\n  top: 10%;\r\n  left: 13%;\r\n  /* transform-origin: 50% -250%; */\r\n  opacity: 0;\r\n  position: fixed;\r\n}\r\n.show0 {\r\n  position: fixed;\r\n  left: 10.09%;\r\n  top: 10%;\r\n  width: 862px;\r\n  height: 1150px;\r\n  opacity: 0;\r\n  /* transform: rotateY(180deg); */\r\n}\r\n.show1234 {\r\n  position: fixed;\r\n  left: 10.09%;\r\n  top: 10%;\r\n  width: 862px;\r\n  height: 1150px;\r\n  opacity: 0;\r\n  /* transform: rotateY(180deg); */\r\n}\r\n.show5 {\r\n  transition: all 1s;\r\n  position: fixed;\r\n  left: 10.09%;\r\n  top: 10%;\r\n  width: 862px;\r\n  height: 1150px;\r\n  opacity: 1;\r\n  transform: scale(0.8);\r\n  transform-origin: 50% 35%;\r\n}\r\n.bg0 {\r\n  width: 63%;\r\n  position: fixed;\r\n  left: 18.5%;\r\n  top: 17%;\r\n  background: black;\r\n  opacity: 0;\r\n}\r\n.bg1234 {\r\n  transition: all 1s;\r\n  position: fixed;\r\n  left: 10.09%;\r\n  top: 10%;\r\n  width: 862px;\r\n  height: 1150px;\r\n  background: black;\r\n}\r\n.bg5 {\r\n  position: fixed;\r\n  transition: all 1s;\r\n  width: 63%;\r\n  position: fixed;\r\n  left: 18.5%;\r\n  top: 17%;\r\n  background: black;\r\n}\r\n/* #canvas {\r\n  width: 862px;\r\n  height: 1150px;\r\n} */\r\n#overlay {\r\n  position: fixed;\r\n  width: 862px;\r\n  height: 1150px;\r\n  left: 10.09%;\r\n  top: 10%;\r\n  background: rgba(255, 255, 255, 0.5);\r\n  display: none;\r\n  /* z-index: 10; */\r\n}\r\n#qrcode {\r\n  position: fixed;\r\n  /* display: inline; */\r\n  left: 40.74%;\r\n  bottom: 4.7%;\r\n  width: 200px !important;\r\n  height: 200px !important;\r\n}\r\n#shareQrcode {\r\n  /* display: none; */\r\n  position: fixed;\r\n  left: 40.74%;\r\n  bottom: 4.7%;\r\n  width: 200px !important;\r\n  height: 200px !important;\r\n}\r\n#paint {\r\n  transition: all 1s;\r\n  position: fixed;\r\n  width: 79.815%;\r\n  height: 59.896%;\r\n  left: 10.09%;\r\n  top: 10%;\r\n  /* transform: rotateY(180deg); */\r\n}\r\n\r\nbody {\r\n  width: 100%;\r\n  height: 100%;\r\n  margin: 0;\r\n}\r\n.container {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.decor-top {\r\n  position: fixed;\r\n  top: 0;\r\n  display: block;\r\n  width: 100%;\r\n}\r\n.decor-bottom {\r\n  position: fixed;\r\n  bottom: 0;\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n.title {\r\n  position: fixed;\r\n  top: 0;\r\n  display: block;\r\n  width: 100%;\r\n  /* width: 1080px; */\r\n  /* height: 324px; */\r\n}\r\n.machine0 {\r\n  transition: all 1s;\r\n  position: fixed;\r\n  top: 0;\r\n  display: block;\r\n  width: 100%;\r\n}\r\n.machine1234 {\r\n  position: fixed;\r\n  top: 0;\r\n  display: block;\r\n  width: 100%;\r\n  /* transform-origin: 50% 58%; */\r\n  transition: all 1s;\r\n\r\n  transform: scale(1.22) translateY(-2%);\r\n  /* transform-origin: 50% 58%; */\r\n}\r\n.machine5 {\r\n  transition: all 1s;\r\n  position: fixed;\r\n  top: -5%;\r\n  display: block;\r\n  width: 100%;\r\n}\r\n.count {\r\n  position: fixed;\r\n  /* height: 20.26%; */\r\n  width: 36.02%;\r\n  top: 28%;\r\n  left: 31.99%;\r\n}\r\n\r\n.input-container {\r\n  text-align: left;\r\n  position: fixed;\r\n  width: 77%;\r\n  left: 11.5%;\r\n  bottom: 32%;\r\n  /* border: beige 2px solid; */\r\n}\r\ninput {\r\n  text-align: left;\r\n  width: 100%;\r\n  height: 200px;\r\n  padding: 20px;\r\n  font-size: 80px;\r\n  border: none;\r\n  box-sizing: border-box;\r\n  background: black;\r\n  color: white;\r\n  opacity: 0.7;\r\n}\r\n.shape-container {\r\n  text-align: left;\r\n  position: fixed;\r\n  width: 77%;\r\n  left: 11.5%;\r\n  bottom: 32%;\r\n  background: black;\r\n}\r\n.shape-container .text {\r\n  font-size: 28px;\r\n  font-weight: normal;\r\n  color: rgba(255, 255, 255, 0.7);\r\n  margin-bottom: 40px;\r\n  margin-top: 30px;\r\n  margin-left: 30px;\r\n}\r\n.shape-container .shapes {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: space-around;\r\n  margin-bottom: 30px;\r\n}\r\n.shape-container .shapes .shape {\r\n  width: 16%;\r\n  opacity: 0.15;\r\n}\r\n.shape-container .shapes .checked-shape {\r\n  width: 16%;\r\n}\r\n.simple-keyboard {\r\n  font-size: 32px;\r\n  max-width: 100%;\r\n  background: black;\r\n}\r\n.hg-theme-default .hg-button {\r\n  background: black;\r\n  color: cadetblue;\r\n}\r\n.btn00 {\r\n  transition-property: width, left, bottom, position;\r\n  transition-duration: 1s, 1s, 1s, 1s;\r\n  width: 68.8%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 18%;\r\n  left: 15.6%;\r\n  /* opacity: 1; */\r\n}\r\n.btn01234 {\r\n  transition: all 1s;\r\n  width: 85%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 13.5%;\r\n  left: 7.5%;\r\n  /* opacity: 0; */\r\n}\r\n.btn05 {\r\n  transition: all 1s;\r\n  position: fixed;\r\n  width: 68.8%;\r\n  bottom: 23%;\r\n  left: 15.6%;\r\n  opacity: 0;\r\n}\r\n.btn0 {\r\n  /* transition: all 1s; */\r\n  width: 64.86%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 12.8%;\r\n  left: 27.6%;\r\n  display: none;\r\n}\r\n.btn1234 {\r\n  /* transition: all 1s; */\r\n  width: 64.86%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 13.5%;\r\n  left: 27.6%;\r\n  /* display: none; */\r\n}\r\n.btn5 {\r\n  transition: all 1s;\r\n  width: 68.8%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 23%;\r\n  left: 15.6%;\r\n  opacity: 1;\r\n}\r\n.back-btn0 {\r\n  width: 16.26%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 18%;\r\n  left: 15.6%;\r\n  display: none;\r\n}\r\n.back-btn1234 {\r\n  width: 19.54%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 13.5%;\r\n  left: 7.5%;\r\n  display: none;\r\n}\r\n.back-btn5 {\r\n  transition: all 1s;\r\n  display: none;\r\n}\r\n.bottom-info0 {\r\n  transition: all 1s;\r\n  width: 29.54%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 5%;\r\n  left: 35%;\r\n}\r\n.bottom-info1234 {\r\n  transition: all 1s;\r\n  width: 29.54%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 1.6%;\r\n  left: 35%;\r\n}\r\n.bottom-info5 {\r\n  transition: all 1s;\r\n  /* width: 19.23%; */\r\n  width: 37.53%;\r\n  /* height: 134px; */\r\n  position: fixed;\r\n  bottom: 1.5%;\r\n  left: 31.235%;\r\n  /* left: 40.385%; */\r\n}\r\n.loading {\r\n  position: fixed;\r\n  width: 120px;\r\n  height: 120px;\r\n  border-radius: 50%;\r\n  top: 36%;\r\n  left: 44.44%;\r\n}\r\n.timestamp {\r\n  background: white;\r\n  color: black;\r\n  position: fixed;\r\n  bottom: 3.5%;\r\n  left: 40.74%;\r\n  width: 200px;\r\n  font-size: 30px;\r\n}\r\n.finish-btn {\r\n  position: fixed;\r\n  height: 200px;\r\n  right: 12%;\r\n}\r\n</style>","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=8174cc82&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport axios from 'axios'\r\nimport '../public/js/gif'\r\nimport '../public/js/gif.worker'\r\n\r\nVue.prototype.$ajax = axios;\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  render: h => h(App),\r\n}).$mount('#app')\r\n","/*\n  GIFEncoder.js\n\n  Authors\n  Kevin Weiner (original Java version - kweiner@fmsware.com)\n  Thibault Imbert (AS3 version - bytearray.org)\n  Johan Nordberg (JS version - code@johan-nordberg.com)\n*/\n\nvar NeuQuant = require('./TypedNeuQuant.js');\nvar LZWEncoder = require('./LZWEncoder.js');\n\nfunction ByteArray() {\n  this.page = -1;\n  this.pages = [];\n  this.newPage();\n}\n\nByteArray.pageSize = 4096;\nByteArray.charMap = {};\n\nfor (var i = 0; i < 256; i++)\n  ByteArray.charMap[i] = String.fromCharCode(i);\n\nByteArray.prototype.newPage = function() {\n  this.pages[++this.page] = new Uint8Array(ByteArray.pageSize);\n  this.cursor = 0;\n};\n\nByteArray.prototype.getData = function() {\n  var rv = '';\n  for (var p = 0; p < this.pages.length; p++) {\n    for (var i = 0; i < ByteArray.pageSize; i++) {\n      rv += ByteArray.charMap[this.pages[p][i]];\n    }\n  }\n  return rv;\n};\n\nByteArray.prototype.writeByte = function(val) {\n  if (this.cursor >= ByteArray.pageSize) this.newPage();\n  this.pages[this.page][this.cursor++] = val;\n};\n\nByteArray.prototype.writeUTFBytes = function(string) {\n  for (var l = string.length, i = 0; i < l; i++)\n    this.writeByte(string.charCodeAt(i));\n};\n\nByteArray.prototype.writeBytes = function(array, offset, length) {\n  for (var l = length || array.length, i = offset || 0; i < l; i++)\n    this.writeByte(array[i]);\n};\n\nfunction GIFEncoder(width, height) {\n  // image size\n  this.width = ~~width;\n  this.height = ~~height;\n\n  // transparent color if given\n  this.transparent = null;\n\n  // transparent index in color table\n  this.transIndex = 0;\n\n  // -1 = no repeat, 0 = forever. anything else is repeat count\n  this.repeat = -1;\n\n  // frame delay (hundredths)\n  this.delay = 0;\n\n  this.image = null; // current frame\n  this.pixels = null; // BGR byte array from frame\n  this.indexedPixels = null; // converted frame indexed to palette\n  this.colorDepth = null; // number of bit planes\n  this.colorTab = null; // RGB palette\n  this.neuQuant = null; // NeuQuant instance that was used to generate this.colorTab.\n  this.usedEntry = new Array(); // active palette entries\n  this.palSize = 7; // color table size (bits-1)\n  this.dispose = -1; // disposal code (-1 = use default)\n  this.firstFrame = true;\n  this.sample = 10; // default sample interval for quantizer\n  this.dither = false; // default dithering\n  this.globalPalette = false;\n\n  this.out = new ByteArray();\n}\n\n/*\n  Sets the delay time between each frame, or changes it for subsequent frames\n  (applies to last frame added)\n*/\nGIFEncoder.prototype.setDelay = function(milliseconds) {\n  this.delay = Math.round(milliseconds / 10);\n};\n\n/*\n  Sets frame rate in frames per second.\n*/\nGIFEncoder.prototype.setFrameRate = function(fps) {\n  this.delay = Math.round(100 / fps);\n};\n\n/*\n  Sets the GIF frame disposal code for the last added frame and any\n  subsequent frames.\n\n  Default is 0 if no transparent color has been set, otherwise 2.\n*/\nGIFEncoder.prototype.setDispose = function(disposalCode) {\n  if (disposalCode >= 0) this.dispose = disposalCode;\n};\n\n/*\n  Sets the number of times the set of GIF frames should be played.\n\n  -1 = play once\n  0 = repeat indefinitely\n\n  Default is -1\n\n  Must be invoked before the first image is added\n*/\n\nGIFEncoder.prototype.setRepeat = function(repeat) {\n  this.repeat = repeat;\n};\n\n/*\n  Sets the transparent color for the last added frame and any subsequent\n  frames. Since all colors are subject to modification in the quantization\n  process, the color in the final palette for each frame closest to the given\n  color becomes the transparent color for that frame. May be set to null to\n  indicate no transparent color.\n*/\nGIFEncoder.prototype.setTransparent = function(color) {\n  this.transparent = color;\n};\n\n/*\n  Adds next GIF frame. The frame is not written immediately, but is\n  actually deferred until the next frame is received so that timing\n  data can be inserted.  Invoking finish() flushes all frames.\n*/\nGIFEncoder.prototype.addFrame = function(imageData) {\n  this.image = imageData;\n\n  this.colorTab = this.globalPalette && this.globalPalette.slice ? this.globalPalette : null;\n\n  this.getImagePixels(); // convert to correct format if necessary\n  this.analyzePixels(); // build color table & map pixels\n\n  if (this.globalPalette === true) this.globalPalette = this.colorTab;\n\n  if (this.firstFrame) {\n    this.writeLSD(); // logical screen descriptior\n    this.writePalette(); // global color table\n    if (this.repeat >= 0) {\n      // use NS app extension to indicate reps\n      this.writeNetscapeExt();\n    }\n  }\n\n  this.writeGraphicCtrlExt(); // write graphic control extension\n  this.writeImageDesc(); // image descriptor\n  if (!this.firstFrame && !this.globalPalette) this.writePalette(); // local color table\n  this.writePixels(); // encode and write pixel data\n\n  this.firstFrame = false;\n};\n\n/*\n  Adds final trailer to the GIF stream, if you don't call the finish method\n  the GIF stream will not be valid.\n*/\nGIFEncoder.prototype.finish = function() {\n  this.out.writeByte(0x3b); // gif trailer\n};\n\n/*\n  Sets quality of color quantization (conversion of images to the maximum 256\n  colors allowed by the GIF specification). Lower values (minimum = 1)\n  produce better colors, but slow processing significantly. 10 is the\n  default, and produces good color mapping at reasonable speeds. Values\n  greater than 20 do not yield significant improvements in speed.\n*/\nGIFEncoder.prototype.setQuality = function(quality) {\n  if (quality < 1) quality = 1;\n  this.sample = quality;\n};\n\n/*\n  Sets dithering method. Available are:\n  - FALSE no dithering\n  - TRUE or FloydSteinberg\n  - FalseFloydSteinberg\n  - Stucki\n  - Atkinson\n  You can add '-serpentine' to use serpentine scanning\n*/\nGIFEncoder.prototype.setDither = function(dither) {\n  if (dither === true) dither = 'FloydSteinberg';\n  this.dither = dither;\n};\n\n/*\n  Sets global palette for all frames.\n  You can provide TRUE to create global palette from first picture.\n  Or an array of r,g,b,r,g,b,...\n*/\nGIFEncoder.prototype.setGlobalPalette = function(palette) {\n  this.globalPalette = palette;\n};\n\n/*\n  Returns global palette used for all frames.\n  If setGlobalPalette(true) was used, then this function will return\n  calculated palette after the first frame is added.\n*/\nGIFEncoder.prototype.getGlobalPalette = function() {\n  return (this.globalPalette && this.globalPalette.slice && this.globalPalette.slice(0)) || this.globalPalette;\n};\n\n/*\n  Writes GIF file header\n*/\nGIFEncoder.prototype.writeHeader = function() {\n  this.out.writeUTFBytes(\"GIF89a\");\n};\n\n/*\n  Analyzes current frame colors and creates color map.\n*/\nGIFEncoder.prototype.analyzePixels = function() {\n  if (!this.colorTab) {\n    this.neuQuant = new NeuQuant(this.pixels, this.sample);\n    this.neuQuant.buildColormap(); // create reduced palette\n    this.colorTab = this.neuQuant.getColormap();\n  }\n\n  // map image pixels to new palette\n  if (this.dither) {\n    this.ditherPixels(this.dither.replace('-serpentine', ''), this.dither.match(/-serpentine/) !== null);\n  } else {\n    this.indexPixels();\n  }\n\n  this.pixels = null;\n  this.colorDepth = 8;\n  this.palSize = 7;\n\n  // get closest match to transparent color if specified\n  if (this.transparent !== null) {\n    this.transIndex = this.findClosest(this.transparent, true);\n  }\n};\n\n/*\n  Index pixels, without dithering\n*/\nGIFEncoder.prototype.indexPixels = function(imgq) {\n  var nPix = this.pixels.length / 3;\n  this.indexedPixels = new Uint8Array(nPix);\n  var k = 0;\n  for (var j = 0; j < nPix; j++) {\n    var index = this.findClosestRGB(\n      this.pixels[k++] & 0xff,\n      this.pixels[k++] & 0xff,\n      this.pixels[k++] & 0xff\n    );\n    this.usedEntry[index] = true;\n    this.indexedPixels[j] = index;\n  }\n};\n\n/*\n  Taken from http://jsbin.com/iXofIji/2/edit by PAEz\n*/\nGIFEncoder.prototype.ditherPixels = function(kernel, serpentine) {\n  var kernels = {\n    FalseFloydSteinberg: [\n      [3 / 8, 1, 0],\n      [3 / 8, 0, 1],\n      [2 / 8, 1, 1]\n    ],\n    FloydSteinberg: [\n      [7 / 16, 1, 0],\n      [3 / 16, -1, 1],\n      [5 / 16, 0, 1],\n      [1 / 16, 1, 1]\n    ],\n    Stucki: [\n      [8 / 42, 1, 0],\n      [4 / 42, 2, 0],\n      [2 / 42, -2, 1],\n      [4 / 42, -1, 1],\n      [8 / 42, 0, 1],\n      [4 / 42, 1, 1],\n      [2 / 42, 2, 1],\n      [1 / 42, -2, 2],\n      [2 / 42, -1, 2],\n      [4 / 42, 0, 2],\n      [2 / 42, 1, 2],\n      [1 / 42, 2, 2]\n    ],\n    Atkinson: [\n      [1 / 8, 1, 0],\n      [1 / 8, 2, 0],\n      [1 / 8, -1, 1],\n      [1 / 8, 0, 1],\n      [1 / 8, 1, 1],\n      [1 / 8, 0, 2]\n    ]\n  };\n\n  if (!kernel || !kernels[kernel]) {\n    throw 'Unknown dithering kernel: ' + kernel;\n  }\n\n  var ds = kernels[kernel];\n  var index = 0,\n    height = this.height,\n    width = this.width,\n    data = this.pixels;\n  var direction = serpentine ? -1 : 1;\n\n  this.indexedPixels = new Uint8Array(this.pixels.length / 3);\n\n  for (var y = 0; y < height; y++) {\n\n    if (serpentine) direction = direction * -1;\n\n    for (var x = (direction == 1 ? 0 : width - 1), xend = (direction == 1 ? width : 0); x !== xend; x += direction) {\n\n      index = (y * width) + x;\n      // Get original colour\n      var idx = index * 3;\n      var r1 = data[idx];\n      var g1 = data[idx + 1];\n      var b1 = data[idx + 2];\n\n      // Get converted colour\n      idx = this.findClosestRGB(r1, g1, b1);\n      this.usedEntry[idx] = true;\n      this.indexedPixels[index] = idx;\n      idx *= 3;\n      var r2 = this.colorTab[idx];\n      var g2 = this.colorTab[idx + 1];\n      var b2 = this.colorTab[idx + 2];\n\n      var er = r1 - r2;\n      var eg = g1 - g2;\n      var eb = b1 - b2;\n\n      for (var i = (direction == 1 ? 0: ds.length - 1), end = (direction == 1 ? ds.length : 0); i !== end; i += direction) {\n        var x1 = ds[i][1]; // *direction;  //  Should this by timesd by direction?..to make the kernel go in the opposite direction....got no idea....\n        var y1 = ds[i][2];\n        if (x1 + x >= 0 && x1 + x < width && y1 + y >= 0 && y1 + y < height) {\n          var d = ds[i][0];\n          idx = index + x1 + (y1 * width);\n          idx *= 3;\n\n          data[idx] = Math.max(0, Math.min(255, data[idx] + er * d));\n          data[idx + 1] = Math.max(0, Math.min(255, data[idx + 1] + eg * d));\n          data[idx + 2] = Math.max(0, Math.min(255, data[idx + 2] + eb * d));\n        }\n      }\n    }\n  }\n};\n\n/*\n  Returns index of palette color closest to c\n*/\nGIFEncoder.prototype.findClosest = function(c, used) {\n  return this.findClosestRGB((c & 0xFF0000) >> 16, (c & 0x00FF00) >> 8, (c & 0x0000FF), used);\n};\n\nGIFEncoder.prototype.findClosestRGB = function(r, g, b, used) {\n  if (this.colorTab === null) return -1;\n\n  if (this.neuQuant && !used) {\n    return this.neuQuant.lookupRGB(r, g, b);\n  }\n  \n  var c = b | (g << 8) | (r << 16);\n\n  var minpos = 0;\n  var dmin = 256 * 256 * 256;\n  var len = this.colorTab.length;\n\n  for (var i = 0, index = 0; i < len; index++) {\n    var dr = r - (this.colorTab[i++] & 0xff);\n    var dg = g - (this.colorTab[i++] & 0xff);\n    var db = b - (this.colorTab[i++] & 0xff);\n    var d = dr * dr + dg * dg + db * db;\n    if ((!used || this.usedEntry[index]) && (d < dmin)) {\n      dmin = d;\n      minpos = index;\n    }\n  }\n\n  return minpos;\n};\n\n/*\n  Extracts image pixels into byte array pixels\n  (removes alphachannel from canvas imagedata)\n*/\nGIFEncoder.prototype.getImagePixels = function() {\n  var w = this.width;\n  var h = this.height;\n  this.pixels = new Uint8Array(w * h * 3);\n\n  var data = this.image;\n  var srcPos = 0;\n  var count = 0;\n\n  for (var i = 0; i < h; i++) {\n    for (var j = 0; j < w; j++) {\n      this.pixels[count++] = data[srcPos++];\n      this.pixels[count++] = data[srcPos++];\n      this.pixels[count++] = data[srcPos++];\n      srcPos++;\n    }\n  }\n};\n\n/*\n  Writes Graphic Control Extension\n*/\nGIFEncoder.prototype.writeGraphicCtrlExt = function() {\n  this.out.writeByte(0x21); // extension introducer\n  this.out.writeByte(0xf9); // GCE label\n  this.out.writeByte(4); // data block size\n\n  var transp, disp;\n  if (this.transparent === null) {\n    transp = 0;\n    disp = 0; // dispose = no action\n  } else {\n    transp = 1;\n    disp = 2; // force clear if using transparent color\n  }\n\n  if (this.dispose >= 0) {\n    disp = dispose & 7; // user override\n  }\n  disp <<= 2;\n\n  // packed fields\n  this.out.writeByte(\n    0 | // 1:3 reserved\n    disp | // 4:6 disposal\n    0 | // 7 user input - 0 = none\n    transp // 8 transparency flag\n  );\n\n  this.writeShort(this.delay); // delay x 1/100 sec\n  this.out.writeByte(this.transIndex); // transparent color index\n  this.out.writeByte(0); // block terminator\n};\n\n/*\n  Writes Image Descriptor\n*/\nGIFEncoder.prototype.writeImageDesc = function() {\n  this.out.writeByte(0x2c); // image separator\n  this.writeShort(0); // image position x,y = 0,0\n  this.writeShort(0);\n  this.writeShort(this.width); // image size\n  this.writeShort(this.height);\n\n  // packed fields\n  if (this.firstFrame || this.globalPalette) {\n    // no LCT - GCT is used for first (or only) frame\n    this.out.writeByte(0);\n  } else {\n    // specify normal LCT\n    this.out.writeByte(\n      0x80 | // 1 local color table 1=yes\n      0 | // 2 interlace - 0=no\n      0 | // 3 sorted - 0=no\n      0 | // 4-5 reserved\n      this.palSize // 6-8 size of color table\n    );\n  }\n};\n\n/*\n  Writes Logical Screen Descriptor\n*/\nGIFEncoder.prototype.writeLSD = function() {\n  // logical screen size\n  this.writeShort(this.width);\n  this.writeShort(this.height);\n\n  // packed fields\n  this.out.writeByte(\n    0x80 | // 1 : global color table flag = 1 (gct used)\n    0x70 | // 2-4 : color resolution = 7\n    0x00 | // 5 : gct sort flag = 0\n    this.palSize // 6-8 : gct size\n  );\n\n  this.out.writeByte(0); // background color index\n  this.out.writeByte(0); // pixel aspect ratio - assume 1:1\n};\n\n/*\n  Writes Netscape application extension to define repeat count.\n*/\nGIFEncoder.prototype.writeNetscapeExt = function() {\n  this.out.writeByte(0x21); // extension introducer\n  this.out.writeByte(0xff); // app extension label\n  this.out.writeByte(11); // block size\n  this.out.writeUTFBytes('NETSCAPE2.0'); // app id + auth code\n  this.out.writeByte(3); // sub-block size\n  this.out.writeByte(1); // loop sub-block id\n  this.writeShort(this.repeat); // loop count (extra iterations, 0=repeat forever)\n  this.out.writeByte(0); // block terminator\n};\n\n/*\n  Writes color table\n*/\nGIFEncoder.prototype.writePalette = function() {\n  this.out.writeBytes(this.colorTab);\n  var n = (3 * 256) - this.colorTab.length;\n  for (var i = 0; i < n; i++)\n    this.out.writeByte(0);\n};\n\nGIFEncoder.prototype.writeShort = function(pValue) {\n  this.out.writeByte(pValue & 0xFF);\n  this.out.writeByte((pValue >> 8) & 0xFF);\n};\n\n/*\n  Encodes and writes pixel data\n*/\nGIFEncoder.prototype.writePixels = function() {\n  var enc = new LZWEncoder(this.width, this.height, this.indexedPixels, this.colorDepth);\n  enc.encode(this.out);\n};\n\n/*\n  Retrieves the GIF stream\n*/\nGIFEncoder.prototype.stream = function() {\n  return this.out;\n};\n\nmodule.exports = GIFEncoder;\n","/*\n  LZWEncoder.js\n\n  Authors\n  Kevin Weiner (original Java version - kweiner@fmsware.com)\n  Thibault Imbert (AS3 version - bytearray.org)\n  Johan Nordberg (JS version - code@johan-nordberg.com)\n\n  Acknowledgements\n  GIFCOMPR.C - GIF Image compression routines\n  Lempel-Ziv compression based on 'compress'. GIF modifications by\n  David Rowley (mgardi@watdcsu.waterloo.edu)\n  GIF Image compression - modified 'compress'\n  Based on: compress.c - File compression ala IEEE Computer, June 1984.\n  By Authors: Spencer W. Thomas (decvax!harpo!utah-cs!utah-gr!thomas)\n  Jim McKie (decvax!mcvax!jim)\n  Steve Davies (decvax!vax135!petsd!peora!srd)\n  Ken Turkowski (decvax!decwrl!turtlevax!ken)\n  James A. Woods (decvax!ihnp4!ames!jaw)\n  Joe Orost (decvax!vax135!petsd!joe)\n*/\n\nvar EOF = -1;\nvar BITS = 12;\nvar HSIZE = 5003; // 80% occupancy\nvar masks = [0x0000, 0x0001, 0x0003, 0x0007, 0x000F, 0x001F,\n             0x003F, 0x007F, 0x00FF, 0x01FF, 0x03FF, 0x07FF,\n             0x0FFF, 0x1FFF, 0x3FFF, 0x7FFF, 0xFFFF];\n\nfunction LZWEncoder(width, height, pixels, colorDepth) {\n  var initCodeSize = Math.max(2, colorDepth);\n\n  var accum = new Uint8Array(256);\n  var htab = new Int32Array(HSIZE);\n  var codetab = new Int32Array(HSIZE);\n\n  var cur_accum, cur_bits = 0;\n  var a_count;\n  var free_ent = 0; // first unused entry\n  var maxcode;\n\n  // block compression parameters -- after all codes are used up,\n  // and compression rate changes, start over.\n  var clear_flg = false;\n\n  // Algorithm: use open addressing double hashing (no chaining) on the\n  // prefix code / next character combination. We do a variant of Knuth's\n  // algorithm D (vol. 3, sec. 6.4) along with G. Knott's relatively-prime\n  // secondary probe. Here, the modular division first probe is gives way\n  // to a faster exclusive-or manipulation. Also do block compression with\n  // an adaptive reset, whereby the code table is cleared when the compression\n  // ratio decreases, but after the table fills. The variable-length output\n  // codes are re-sized at this point, and a special CLEAR code is generated\n  // for the decompressor. Late addition: construct the table according to\n  // file size for noticeable speed improvement on small files. Please direct\n  // questions about this implementation to ames!jaw.\n  var g_init_bits, ClearCode, EOFCode;\n\n  // Add a character to the end of the current packet, and if it is 254\n  // characters, flush the packet to disk.\n  function char_out(c, outs) {\n    accum[a_count++] = c;\n    if (a_count >= 254) flush_char(outs);\n  }\n\n  // Clear out the hash table\n  // table clear for block compress\n  function cl_block(outs) {\n    cl_hash(HSIZE);\n    free_ent = ClearCode + 2;\n    clear_flg = true;\n    output(ClearCode, outs);\n  }\n\n  // Reset code table\n  function cl_hash(hsize) {\n    for (var i = 0; i < hsize; ++i) htab[i] = -1;\n  }\n\n  function compress(init_bits, outs) {\n    var fcode, c, i, ent, disp, hsize_reg, hshift;\n\n    // Set up the globals: g_init_bits - initial number of bits\n    g_init_bits = init_bits;\n\n    // Set up the necessary values\n    clear_flg = false;\n    n_bits = g_init_bits;\n    maxcode = MAXCODE(n_bits);\n\n    ClearCode = 1 << (init_bits - 1);\n    EOFCode = ClearCode + 1;\n    free_ent = ClearCode + 2;\n\n    a_count = 0; // clear packet\n\n    ent = nextPixel();\n\n    hshift = 0;\n    for (fcode = HSIZE; fcode < 65536; fcode *= 2) ++hshift;\n    hshift = 8 - hshift; // set hash code range bound\n    hsize_reg = HSIZE;\n    cl_hash(hsize_reg); // clear hash table\n\n    output(ClearCode, outs);\n\n    outer_loop: while ((c = nextPixel()) != EOF) {\n      fcode = (c << BITS) + ent;\n      i = (c << hshift) ^ ent; // xor hashing\n      if (htab[i] === fcode) {\n        ent = codetab[i];\n        continue;\n      } else if (htab[i] >= 0) { // non-empty slot\n        disp = hsize_reg - i; // secondary hash (after G. Knott)\n        if (i === 0) disp = 1;\n        do {\n          if ((i -= disp) < 0) i += hsize_reg;\n          if (htab[i] === fcode) {\n            ent = codetab[i];\n            continue outer_loop;\n          }\n        } while (htab[i] >= 0);\n      }\n      output(ent, outs);\n      ent = c;\n      if (free_ent < 1 << BITS) {\n        codetab[i] = free_ent++; // code -> hashtable\n        htab[i] = fcode;\n      } else {\n        cl_block(outs);\n      }\n    }\n\n    // Put out the final code.\n    output(ent, outs);\n    output(EOFCode, outs);\n  }\n\n  function encode(outs) {\n    outs.writeByte(initCodeSize); // write \"initial code size\" byte\n    remaining = width * height; // reset navigation variables\n    curPixel = 0;\n    compress(initCodeSize + 1, outs); // compress and write the pixel data\n    outs.writeByte(0); // write block terminator\n  }\n\n  // Flush the packet to disk, and reset the accumulator\n  function flush_char(outs) {\n    if (a_count > 0) {\n      outs.writeByte(a_count);\n      outs.writeBytes(accum, 0, a_count);\n      a_count = 0;\n    }\n  }\n\n  function MAXCODE(n_bits) {\n    return (1 << n_bits) - 1;\n  }\n\n  // Return the next pixel from the image\n  function nextPixel() {\n    if (remaining === 0) return EOF;\n    --remaining;\n    var pix = pixels[curPixel++];\n    return pix & 0xff;\n  }\n\n  function output(code, outs) {\n    cur_accum &= masks[cur_bits];\n\n    if (cur_bits > 0) cur_accum |= (code << cur_bits);\n    else cur_accum = code;\n\n    cur_bits += n_bits;\n\n    while (cur_bits >= 8) {\n      char_out((cur_accum & 0xff), outs);\n      cur_accum >>= 8;\n      cur_bits -= 8;\n    }\n\n    // If the next entry is going to be too big for the code size,\n    // then increase it, if possible.\n    if (free_ent > maxcode || clear_flg) {\n      if (clear_flg) {\n        maxcode = MAXCODE(n_bits = g_init_bits);\n        clear_flg = false;\n      } else {\n        ++n_bits;\n        if (n_bits == BITS) maxcode = 1 << BITS;\n        else maxcode = MAXCODE(n_bits);\n      }\n    }\n\n    if (code == EOFCode) {\n      // At EOF, write the rest of the buffer.\n      while (cur_bits > 0) {\n        char_out((cur_accum & 0xff), outs);\n        cur_accum >>= 8;\n        cur_bits -= 8;\n      }\n      flush_char(outs);\n    }\n  }\n\n  this.encode = encode;\n}\n\nmodule.exports = LZWEncoder;\n","/* NeuQuant Neural-Net Quantization Algorithm\n * ------------------------------------------\n *\n * Copyright (c) 1994 Anthony Dekker\n *\n * NEUQUANT Neural-Net quantization algorithm by Anthony Dekker, 1994.\n * See \"Kohonen neural networks for optimal colour quantization\"\n * in \"Network: Computation in Neural Systems\" Vol. 5 (1994) pp 351-367.\n * for a discussion of the algorithm.\n * See also  http://members.ozemail.com.au/~dekker/NEUQUANT.HTML\n *\n * Any party obtaining a copy of these files from the author, directly or\n * indirectly, is granted, free of charge, a full and unrestricted irrevocable,\n * world-wide, paid up, royalty-free, nonexclusive right and license to deal\n * in this software and documentation files (the \"Software\"), including without\n * limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons who receive\n * copies from any such party to do so, with the only requirement being\n * that this copyright notice remain intact.\n *\n * (JavaScript port 2012 by Johan Nordberg)\n */\n\nvar ncycles = 100; // number of learning cycles\nvar netsize = 256; // number of colors used\nvar maxnetpos = netsize - 1;\n\n// defs for freq and bias\nvar netbiasshift = 4; // bias for colour values\nvar intbiasshift = 16; // bias for fractions\nvar intbias = (1 << intbiasshift);\nvar gammashift = 10;\nvar gamma = (1 << gammashift);\nvar betashift = 10;\nvar beta = (intbias >> betashift); /* beta = 1/1024 */\nvar betagamma = (intbias << (gammashift - betashift));\n\n// defs for decreasing radius factor\nvar initrad = (netsize >> 3); // for 256 cols, radius starts\nvar radiusbiasshift = 6; // at 32.0 biased by 6 bits\nvar radiusbias = (1 << radiusbiasshift);\nvar initradius = (initrad * radiusbias); //and decreases by a\nvar radiusdec = 30; // factor of 1/30 each cycle\n\n// defs for decreasing alpha factor\nvar alphabiasshift = 10; // alpha starts at 1.0\nvar initalpha = (1 << alphabiasshift);\nvar alphadec; // biased by 10 bits\n\n/* radbias and alpharadbias used for radpower calculation */\nvar radbiasshift = 8;\nvar radbias = (1 << radbiasshift);\nvar alpharadbshift = (alphabiasshift + radbiasshift);\nvar alpharadbias = (1 << alpharadbshift);\n\n// four primes near 500 - assume no image has a length so large that it is\n// divisible by all four primes\nvar prime1 = 499;\nvar prime2 = 491;\nvar prime3 = 487;\nvar prime4 = 503;\nvar minpicturebytes = (3 * prime4);\n\n/*\n  Constructor: NeuQuant\n\n  Arguments:\n\n  pixels - array of pixels in RGB format\n  samplefac - sampling factor 1 to 30 where lower is better quality\n\n  >\n  > pixels = [r, g, b, r, g, b, r, g, b, ..]\n  >\n*/\nfunction NeuQuant(pixels, samplefac) {\n  var network; // int[netsize][4]\n  var netindex; // for network lookup - really 256\n\n  // bias and freq arrays for learning\n  var bias;\n  var freq;\n  var radpower;\n\n  /*\n    Private Method: init\n\n    sets up arrays\n  */\n  function init() {\n    network = [];\n    netindex = new Int32Array(256);\n    bias = new Int32Array(netsize);\n    freq = new Int32Array(netsize);\n    radpower = new Int32Array(netsize >> 3);\n\n    var i, v;\n    for (i = 0; i < netsize; i++) {\n      v = (i << (netbiasshift + 8)) / netsize;\n      network[i] = new Float64Array([v, v, v, 0]);\n      //network[i] = [v, v, v, 0]\n      freq[i] = intbias / netsize;\n      bias[i] = 0;\n    }\n  }\n\n  /*\n    Private Method: unbiasnet\n\n    unbiases network to give byte values 0..255 and record position i to prepare for sort\n  */\n  function unbiasnet() {\n    for (var i = 0; i < netsize; i++) {\n      network[i][0] >>= netbiasshift;\n      network[i][1] >>= netbiasshift;\n      network[i][2] >>= netbiasshift;\n      network[i][3] = i; // record color number\n    }\n  }\n\n  /*\n    Private Method: altersingle\n\n    moves neuron *i* towards biased (b,g,r) by factor *alpha*\n  */\n  function altersingle(alpha, i, b, g, r) {\n    network[i][0] -= (alpha * (network[i][0] - b)) / initalpha;\n    network[i][1] -= (alpha * (network[i][1] - g)) / initalpha;\n    network[i][2] -= (alpha * (network[i][2] - r)) / initalpha;\n  }\n\n  /*\n    Private Method: alterneigh\n\n    moves neurons in *radius* around index *i* towards biased (b,g,r) by factor *alpha*\n  */\n  function alterneigh(radius, i, b, g, r) {\n    var lo = Math.abs(i - radius);\n    var hi = Math.min(i + radius, netsize);\n\n    var j = i + 1;\n    var k = i - 1;\n    var m = 1;\n\n    var p, a;\n    while ((j < hi) || (k > lo)) {\n      a = radpower[m++];\n\n      if (j < hi) {\n        p = network[j++];\n        p[0] -= (a * (p[0] - b)) / alpharadbias;\n        p[1] -= (a * (p[1] - g)) / alpharadbias;\n        p[2] -= (a * (p[2] - r)) / alpharadbias;\n      }\n\n      if (k > lo) {\n        p = network[k--];\n        p[0] -= (a * (p[0] - b)) / alpharadbias;\n        p[1] -= (a * (p[1] - g)) / alpharadbias;\n        p[2] -= (a * (p[2] - r)) / alpharadbias;\n      }\n    }\n  }\n\n  /*\n    Private Method: contest\n\n    searches for biased BGR values\n  */\n  function contest(b, g, r) {\n    /*\n      finds closest neuron (min dist) and updates freq\n      finds best neuron (min dist-bias) and returns position\n      for frequently chosen neurons, freq[i] is high and bias[i] is negative\n      bias[i] = gamma * ((1 / netsize) - freq[i])\n    */\n\n    var bestd = ~(1 << 31);\n    var bestbiasd = bestd;\n    var bestpos = -1;\n    var bestbiaspos = bestpos;\n\n    var i, n, dist, biasdist, betafreq;\n    for (i = 0; i < netsize; i++) {\n      n = network[i];\n\n      dist = Math.abs(n[0] - b) + Math.abs(n[1] - g) + Math.abs(n[2] - r);\n      if (dist < bestd) {\n        bestd = dist;\n        bestpos = i;\n      }\n\n      biasdist = dist - ((bias[i]) >> (intbiasshift - netbiasshift));\n      if (biasdist < bestbiasd) {\n        bestbiasd = biasdist;\n        bestbiaspos = i;\n      }\n\n      betafreq = (freq[i] >> betashift);\n      freq[i] -= betafreq;\n      bias[i] += (betafreq << gammashift);\n    }\n\n    freq[bestpos] += beta;\n    bias[bestpos] -= betagamma;\n\n    return bestbiaspos;\n  }\n\n  /*\n    Private Method: inxbuild\n\n    sorts network and builds netindex[0..255]\n  */\n  function inxbuild() {\n    var i, j, p, q, smallpos, smallval, previouscol = 0, startpos = 0;\n    for (i = 0; i < netsize; i++) {\n      p = network[i];\n      smallpos = i;\n      smallval = p[1]; // index on g\n      // find smallest in i..netsize-1\n      for (j = i + 1; j < netsize; j++) {\n        q = network[j];\n        if (q[1] < smallval) { // index on g\n          smallpos = j;\n          smallval = q[1]; // index on g\n        }\n      }\n      q = network[smallpos];\n      // swap p (i) and q (smallpos) entries\n      if (i != smallpos) {\n        j = q[0];   q[0] = p[0];   p[0] = j;\n        j = q[1];   q[1] = p[1];   p[1] = j;\n        j = q[2];   q[2] = p[2];   p[2] = j;\n        j = q[3];   q[3] = p[3];   p[3] = j;\n      }\n      // smallval entry is now in position i\n\n      if (smallval != previouscol) {\n        netindex[previouscol] = (startpos + i) >> 1;\n        for (j = previouscol + 1; j < smallval; j++)\n          netindex[j] = i;\n        previouscol = smallval;\n        startpos = i;\n      }\n    }\n    netindex[previouscol] = (startpos + maxnetpos) >> 1;\n    for (j = previouscol + 1; j < 256; j++)\n      netindex[j] = maxnetpos; // really 256\n  }\n\n  /*\n    Private Method: inxsearch\n\n    searches for BGR values 0..255 and returns a color index\n  */\n  function inxsearch(b, g, r) {\n    var a, p, dist;\n\n    var bestd = 1000; // biggest possible dist is 256*3\n    var best = -1;\n\n    var i = netindex[g]; // index on g\n    var j = i - 1; // start at netindex[g] and work outwards\n\n    while ((i < netsize) || (j >= 0)) {\n      if (i < netsize) {\n        p = network[i];\n        dist = p[1] - g; // inx key\n        if (dist >= bestd) i = netsize; // stop iter\n        else {\n          i++;\n          if (dist < 0) dist = -dist;\n          a = p[0] - b; if (a < 0) a = -a;\n          dist += a;\n          if (dist < bestd) {\n            a = p[2] - r; if (a < 0) a = -a;\n            dist += a;\n            if (dist < bestd) {\n              bestd = dist;\n              best = p[3];\n            }\n          }\n        }\n      }\n      if (j >= 0) {\n        p = network[j];\n        dist = g - p[1]; // inx key - reverse dif\n        if (dist >= bestd) j = -1; // stop iter\n        else {\n          j--;\n          if (dist < 0) dist = -dist;\n          a = p[0] - b; if (a < 0) a = -a;\n          dist += a;\n          if (dist < bestd) {\n            a = p[2] - r; if (a < 0) a = -a;\n            dist += a;\n            if (dist < bestd) {\n              bestd = dist;\n              best = p[3];\n            }\n          }\n        }\n      }\n    }\n\n    return best;\n  }\n\n  /*\n    Private Method: learn\n\n    \"Main Learning Loop\"\n  */\n  function learn() {\n    var i;\n\n    var lengthcount = pixels.length;\n    var alphadec = 30 + ((samplefac - 1) / 3);\n    var samplepixels = lengthcount / (3 * samplefac);\n    var delta = ~~(samplepixels / ncycles);\n    var alpha = initalpha;\n    var radius = initradius;\n\n    var rad = radius >> radiusbiasshift;\n\n    if (rad <= 1) rad = 0;\n    for (i = 0; i < rad; i++)\n      radpower[i] = alpha * (((rad * rad - i * i) * radbias) / (rad * rad));\n\n    var step;\n    if (lengthcount < minpicturebytes) {\n      samplefac = 1;\n      step = 3;\n    } else if ((lengthcount % prime1) !== 0) {\n      step = 3 * prime1;\n    } else if ((lengthcount % prime2) !== 0) {\n      step = 3 * prime2;\n    } else if ((lengthcount % prime3) !== 0)  {\n      step = 3 * prime3;\n    } else {\n      step = 3 * prime4;\n    }\n\n    var b, g, r, j;\n    var pix = 0; // current pixel\n\n    i = 0;\n    while (i < samplepixels) {\n      b = (pixels[pix] & 0xff) << netbiasshift;\n      g = (pixels[pix + 1] & 0xff) << netbiasshift;\n      r = (pixels[pix + 2] & 0xff) << netbiasshift;\n\n      j = contest(b, g, r);\n\n      altersingle(alpha, j, b, g, r);\n      if (rad !== 0) alterneigh(rad, j, b, g, r); // alter neighbours\n\n      pix += step;\n      if (pix >= lengthcount) pix -= lengthcount;\n\n      i++;\n\n      if (delta === 0) delta = 1;\n      if (i % delta === 0) {\n        alpha -= alpha / alphadec;\n        radius -= radius / radiusdec;\n        rad = radius >> radiusbiasshift;\n\n        if (rad <= 1) rad = 0;\n        for (j = 0; j < rad; j++)\n          radpower[j] = alpha * (((rad * rad - j * j) * radbias) / (rad * rad));\n      }\n    }\n  }\n\n  /*\n    Method: buildColormap\n\n    1. initializes network\n    2. trains it\n    3. removes misconceptions\n    4. builds colorindex\n  */\n  function buildColormap() {\n    init();\n    learn();\n    unbiasnet();\n    inxbuild();\n  }\n  this.buildColormap = buildColormap;\n\n  /*\n    Method: getColormap\n\n    builds colormap from the index\n\n    returns array in the format:\n\n    >\n    > [r, g, b, r, g, b, r, g, b, ..]\n    >\n  */\n  function getColormap() {\n    var map = [];\n    var index = [];\n\n    for (var i = 0; i < netsize; i++)\n      index[network[i][3]] = i;\n\n    var k = 0;\n    for (var l = 0; l < netsize; l++) {\n      var j = index[l];\n      map[k++] = (network[j][0]);\n      map[k++] = (network[j][1]);\n      map[k++] = (network[j][2]);\n    }\n    return map;\n  }\n  this.getColormap = getColormap;\n\n  /*\n    Method: lookupRGB\n\n    looks for the closest *r*, *g*, *b* color in the map and\n    returns its index\n  */\n  this.lookupRGB = inxsearch;\n}\n\nmodule.exports = NeuQuant;\n","GIFEncoder = require './GIFEncoder.js'\n\nrenderFrame = (frame) ->\n  encoder = new GIFEncoder frame.width, frame.height\n\n  if frame.index is 0\n    encoder.writeHeader()\n  else\n    encoder.firstFrame = false\n\n  encoder.setTransparent frame.transparent\n  encoder.setRepeat frame.repeat\n  encoder.setDelay frame.delay\n  encoder.setQuality frame.quality\n  encoder.setDither frame.dither\n  encoder.setGlobalPalette frame.globalPalette\n  encoder.addFrame frame.data\n  encoder.finish() if frame.last\n  if frame.globalPalette == true\n    frame.globalPalette = encoder.getGlobalPalette()\n\n  stream = encoder.stream()\n  frame.data = stream.pages\n  frame.cursor = stream.cursor\n  frame.pageSize = stream.constructor.pageSize\n\n  if frame.canTransfer\n    transfer = (page.buffer for page in frame.data)\n    self.postMessage frame, transfer\n  else\n    self.postMessage frame\n\nself.onmessage = (event) -> renderFrame event.data\n"],"sourceRoot":""}